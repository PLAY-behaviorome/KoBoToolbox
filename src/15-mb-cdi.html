<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>15-mb-cdi.knit</title>

  
   
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="15-mb-cdi.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="15-mb-cdi.knit" />
  
  
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.4.2/transition.js"></script>
    <script src="libs/bs3compat-0.4.2/tabs.js"></script>
    <script src="libs/bs3compat-0.4.2/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
      <link rel="stylesheet" href="include/css/style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<!--bookdown:title:start-->
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title=""></a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="mb-cdi" class="section level1 unnumbered">
<h1 class="unnumbered">MB-CDI</h1>
<div id="purpose" class="section level2 unnumbered">
<h2 class="unnumbered">Purpose</h2>
<p>This page documents the cleaning and merging procedures related to the MB-CDI data.
The home visit workflow strips these files into their own set of CSVs under <code>data/csv/home_visit/mbcdi</code>.</p>
<p>The aggregate (across language group and age) data files are saved under <code>data/csv/agg</code>.</p>
</div>
<div id="preparation" class="section level2 unnumbered">
<h2 class="unnumbered">Preparation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;R&quot;</span>, <span class="st">&quot;_OLD&quot;</span>, <span class="st">&quot;functions.R&quot;</span>))</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>purrr<span class="sc">::</span><span class="fu">walk</span>(<span class="fu">list.files</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;R&quot;</span>), <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.R$&quot;</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>), source)</span></code></pre></div>
<p>Letâ€™s investigate the number of files, records, and variables per file.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>mbcdi_fns <span class="ot">&lt;-</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;data&quot;</span>, <span class="st">&quot;csv&quot;</span>, <span class="st">&quot;home_visit&quot;</span>, <span class="st">&quot;mbcdi&quot;</span>), <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.csv$&quot;</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">length</span>(mbcdi_fns)</span></code></pre></div>
<pre><code>## [1] 25</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>make_datafile_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(csv) {</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  assertthat<span class="sc">::</span><span class="fu">is.string</span>(csv)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  assertthat<span class="sc">::</span><span class="fu">is.readable</span>(csv)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  </span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  df <span class="ot">&lt;-</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">read_csv</span>(csv,</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>                    <span class="at">col_types =</span> readr<span class="sc">::</span><span class="fu">cols</span>(<span class="at">.default =</span> <span class="st">&#39;c&#39;</span>),</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>                    <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  </span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  </span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  </span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">fn =</span> csv,</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>             <span class="at">age_group =</span> <span class="fu">extract_age_group_from_name</span>(csv),</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>             <span class="at">lang_cond =</span> <span class="fu">form_language</span>(csv),</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>             <span class="at">n_subs =</span> <span class="fu">dim</span>(df)[<span class="dv">1</span>],</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>             <span class="at">n_vars =</span> <span class="fu">dim</span>(df)[<span class="dv">2</span>])</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>mbcdi_file_dat <span class="ot">&lt;-</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(mbcdi_fns, make_datafile_summary) <span class="sc">|&gt;</span> purrr<span class="sc">::</span><span class="fu">list_rbind</span>()</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>mbcdi_file_dat <span class="sc">|&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(age_group, lang_cond, n_subs) <span class="sc">|&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&#39;html&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_classic</span>()</span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
fn
</th>
<th style="text-align:left;">
age_group
</th>
<th style="text-align:left;">
lang_cond
</th>
<th style="text-align:right;">
n_subs
</th>
<th style="text-align:right;">
n_vars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/334099_mbcdi_12_bilingual_english.csv
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
bilingual_english
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
730
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/411456_mbcdi_12_bilingual_english.csv
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
bilingual_english
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
717
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/740623_mbcdi_12_bilingual_english.csv
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
bilingual_english
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
712
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/740624_mbcdi_12_bilingual_spanish.csv
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
bilingual_spanish
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
712
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/411469_mbcdi_12_bilingual_spanish.csv
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
bilingual_spanish
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
717
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/331848_mbcdi_12_english.csv
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
english
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
256
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/363431_mbcdi_12_english.csv
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
english
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
255
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/740625_mbcdi_12_english.csv
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
english
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
259
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/363466_mbcdi_18_bilingual_english.csv
</td>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
bilingual_english
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
815
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/740626_mbcdi_18_bilingual_english.csv
</td>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
bilingual_english
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
829
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/411388_mbcdi_18_bilingual_spanish.csv
</td>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
bilingual_spanish
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
815
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/740627_mbcdi_18_bilingual_spanish.csv
</td>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
bilingual_spanish
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
829
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/1136694_mbcdi_18_english.csv
</td>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
english
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
359
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/1151489_mbcdi_18_english.csv
</td>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
english
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
359
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/307736_mbcdi_18_english.csv
</td>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
english
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
352
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/363349_mbcdi_18_english.csv
</td>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
english
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
352
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/740628_mbcdi_18_english.csv
</td>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
english
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
358
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/363465_mbcdi_24_bilingual_english.csv
</td>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
bilingual_english
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
815
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/740631_mbcdi_24_bilingual_english.csv
</td>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
bilingual_english
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
829
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/408149_mbcdi_24_bilingual_spanish.csv
</td>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
bilingual_spanish
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
815
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/740630_mbcdi_24_bilingual_spanish.csv
</td>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
bilingual_spanish
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
829
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/740631_mbcdi_24_bilingual_spanish.csv
</td>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
bilingual_spanish
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
830
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/331453_mbcdi_24_english.csv
</td>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
english
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
352
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/363381_mbcdi_24_english.csv
</td>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
english
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
352
</td>
</tr>
<tr>
<td style="text-align:left;">
/Users/rog1/rrr/KoBoToolbox/data/csv/home_visit/mbcdi/740629_mbcdi_24_english.csv
</td>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
english
</td>
<td style="text-align:right;">
98
</td>
<td style="text-align:right;">
358
</td>
</tr>
</tbody>
</table>
</div>
<div id="mo-old-english-speakers" class="section level2 unnumbered">
<h2 class="unnumbered">12-mo-old English speakers</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>eng_12_files <span class="ot">&lt;-</span> mbcdi_file_dat <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(age_group <span class="sc">==</span> <span class="st">&#39;12&#39;</span>, lang_cond <span class="sc">==</span> <span class="st">&#39;english&#39;</span>, n_subs <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>eng_12_combined_df <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(eng_12_files<span class="sc">$</span>fn, mcdi_clean_12_csv) <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">list_rbind</span>()</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>eng_12_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;data&quot;</span>, <span class="st">&quot;csv&quot;</span>, <span class="st">&quot;home_visit&quot;</span>, <span class="st">&quot;agg&quot;</span>, <span class="st">&quot;mcdi_english_12_combined.csv&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_csv</span>(eng_12_combined_df, eng_12_fn)</span></code></pre></div>
<p>There are <span class="math inline">\(n=\)</span> 137 participant records.</p>
</div>
<div id="mo-old-english-speakers-1" class="section level2 unnumbered">
<h2 class="unnumbered">18-mo-old English speakers</h2>
<div class="rmdnote">
<p>This code should be wrapped in functions since many of the components duplicate one another.</p>
</div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>eng_18_files <span class="ot">&lt;-</span> mbcdi_file_dat <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(age_group <span class="sc">==</span> <span class="st">&#39;18&#39;</span>, lang_cond <span class="sc">==</span> <span class="st">&#39;english&#39;</span>, n_subs <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>eng_18_combined_df <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(eng_18_files<span class="sc">$</span>fn, mcdi_clean_18_24_csv) <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">list_rbind</span>()</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>eng_18_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;data&quot;</span>, <span class="st">&quot;csv&quot;</span>, <span class="st">&quot;home_visit&quot;</span>, <span class="st">&quot;agg&quot;</span>, <span class="st">&quot;mcdi_english_18_combined.csv&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_csv</span>(eng_18_combined_df, eng_18_fn)</span></code></pre></div>
<p>There are <span class="math inline">\(n=\)</span> 123 participant records.</p>
</div>
<div id="mo-old-english-speakers-2" class="section level2 unnumbered">
<h2 class="unnumbered">24-mo-old English speakers</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>eng_24_files <span class="ot">&lt;-</span> mbcdi_file_dat <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(age_group <span class="sc">==</span> <span class="st">&#39;24&#39;</span>, lang_cond <span class="sc">==</span> <span class="st">&#39;english&#39;</span>, n_subs <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>eng_24_combined_df <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(eng_24_files<span class="sc">$</span>fn, mcdi_clean_18_24_csv) <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">list_rbind</span>()</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>eng_24_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;data&quot;</span>, <span class="st">&quot;csv&quot;</span>, <span class="st">&quot;home_visit&quot;</span>, <span class="st">&quot;agg&quot;</span>, <span class="st">&quot;mcdi_english_24_combined.csv&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_csv</span>(eng_24_combined_df, eng_24_fn)</span></code></pre></div>
<p>There are <span class="math inline">\(n=\)</span> 123 participant records.</p>
</div>
<div id="old-code" class="section level2 unnumbered">
<h2 class="unnumbered">Old code</h2>
<div class="rmdnote">
<p>The following code is deprecated as of 2023-10-25, and is <em>not</em> run.</p>
</div>
<p>For simplicity, weâ€™ll start with the youngest age group, and with the English speakers.
There are <span class="math inline">\(n=3\)</span> forms, with 4, 10, and 111 participants each, and 254, 253, and 257 variables.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>eng_12_files <span class="ot">&lt;-</span> mbcdi_file_dat <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(age_group <span class="sc">==</span> <span class="st">&#39;12&#39;</span>, lang_cond <span class="sc">==</span> <span class="st">&#39;english&#39;</span>, n_subs <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code></pre></div>
<p>Weâ€™ll examine the first one.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>eng_12_331 <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(eng_12_files<span class="sc">$</span>fn[<span class="dv">1</span>],</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>                    <span class="at">col_types =</span> readr<span class="sc">::</span><span class="fu">cols</span>(<span class="at">.default =</span> <span class="st">&#39;c&#39;</span>),</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>                    <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="fu">names</span>(eng_12_331) <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code></pre></div>
<p>Letâ€™s try trimming the metadata labels.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>eng_12_331_trim_names <span class="ot">&lt;-</span> </span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  <span class="fu">names</span>(eng_12_331) <span class="sc">|&gt;</span> <span class="fu">basename</span>()</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>eng_12_331_trim_names <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code></pre></div>
<p>That looks better.
Letâ€™s look at the second file.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>eng_12_363 <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(eng_12_files<span class="sc">$</span>fn[<span class="dv">2</span>],</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>                    <span class="at">col_types =</span> readr<span class="sc">::</span><span class="fu">cols</span>(<span class="at">.default =</span> <span class="st">&#39;c&#39;</span>),</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>                    <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="fu">names</span>(eng_12_363) <span class="sc">|&gt;</span> <span class="fu">basename</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code></pre></div>
<p>And the third one.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>eng_12_740625 <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(eng_12_files<span class="sc">$</span>fn[<span class="dv">3</span>],</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>                    <span class="at">col_types =</span> readr<span class="sc">::</span><span class="fu">cols</span>(<span class="at">.default =</span> <span class="st">&#39;c&#39;</span>),</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>                    <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="fu">names</span>(eng_12_740625) <span class="sc">|&gt;</span> <span class="fu">basename</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code></pre></div>
<p>Now, weâ€™ll create a function to clean the variable names.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>select_basename <span class="ot">&lt;-</span> <span class="cf">function</span>(csv_fn) {</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  assertthat<span class="sc">::</span><span class="fu">is.string</span>(csv_fn)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  assertthat<span class="sc">::</span><span class="fu">is.readable</span>(csv_fn)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  </span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(csv_fn,</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>                    <span class="at">col_types =</span> readr<span class="sc">::</span><span class="fu">cols</span>(<span class="at">.default =</span> <span class="st">&#39;c&#39;</span>),</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>                    <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>  </span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  <span class="fu">names</span>(df) <span class="ot">&lt;-</span> <span class="fu">basename</span>(<span class="fu">names</span>(df))</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  df</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">select_basename</span>(eng_12_files<span class="sc">$</span>fn[<span class="dv">3</span>]) <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code></pre></div>
<p>Letâ€™s trim unneeded fields.
Weâ€™ll write several helper functions to do this.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>trim_cdi_fields <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  df <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;note&quot;</span>),</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>                  <span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;instructions&quot;</span>),</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>                  <span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;comments&quot;</span>),</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>                  <span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;continue&quot;</span>),</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>                  <span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;vocab&quot;</span>),</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>                  <span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;mcdi&quot;</span>))</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>}</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>add_particip_index <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>  df <span class="sc">|&gt;</span> </span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">play_i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(df)[<span class="dv">1</span>])</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>}</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>make_cdi_longer <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a>  n_vars <span class="ot">&lt;-</span> <span class="fu">dim</span>(df)[<span class="dv">2</span>]</span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>  df <span class="sc">|&gt;</span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span>n_vars,</span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a>                        <span class="at">names_to =</span> <span class="st">&quot;word&quot;</span>,</span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a>                        <span class="at">values_to =</span> <span class="st">&quot;understands_or_says&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(understands_or_says)) <span class="sc">|&gt;</span></span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">understands_or_says =</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(understands_or_says, <span class="st">&quot;understands___&quot;</span>, <span class="st">&quot;says&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a>      <span class="at">understands_or_says =</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(understands_or_says, <span class="st">&quot;understands_says&quot;</span>, <span class="st">&quot;says&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">word =</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(word, <span class="st">&quot;mommy_001&quot;</span>, <span class="st">&quot;mommy&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">word =</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(word, <span class="st">&quot;bath_001&quot;</span>, <span class="st">&quot;bath&quot;</span>))</span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we combine them into an omnibus function.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>clean_cdi <span class="ot">&lt;-</span> <span class="cf">function</span>(csv_fn) {</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="fu">select_basename</span>(csv_fn) <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>    <span class="fu">trim_cdi_fields</span>() <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;play_id&quot;</span> <span class="ot">=</span> <span class="st">&quot;participant_id&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>    <span class="fu">make_cdi_longer</span>() <span class="sc">|&gt;</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>    <span class="fu">add_particip_index</span>()</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>}</span></code></pre></div>
<p>Now, we can run <code>clean_cdi()</code> across all three files.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>eng_12 <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(eng_12_files<span class="sc">$</span>fn, clean_cdi) <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">list_rbind</span>()</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span> word <span class="sc">+</span> understands_or_says, eng_12)</span></code></pre></div>
</div>
<div id="mo-old-english-speakers-3" class="section level2 unnumbered">
<h2 class="unnumbered">18-mo-old English speakers</h2>
<p>Letâ€™s move on to the 18-mo-old English speakers.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>eng_18_files <span class="ot">&lt;-</span> mbcdi_file_dat <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(age_group <span class="sc">==</span> <span class="st">&#39;18&#39;</span>, lang_cond <span class="sc">==</span> <span class="st">&#39;english&#39;</span>, n_subs <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code></pre></div>
<p>There are <span class="math inline">\(n=\)</span> 3 files with participant data.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">clean_cdi</span>(eng_18_files<span class="sc">$</span>fn[<span class="dv">1</span>])</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="fu">clean_cdi</span>(eng_18_files<span class="sc">$</span>fn[<span class="dv">2</span>])</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="fu">clean_cdi</span>(eng_18_files<span class="sc">$</span>fn[<span class="dv">3</span>])</span></code></pre></div>
<p>There are some duplicate entries for some words.</p>
<div class="rmdnote">
<p><del>We need a strategy for reconciling these duplicates: <code>candy</code>, <code>leg</code>, <code>rain</code>, <code>wet</code>.</del></p>
<p>Itâ€™s not elegant, but I have one for modifying the duplicate names. See below.</p>
</div>
</div>
<div id="mo-old-english-speakers-4" class="section level2 unnumbered">
<h2 class="unnumbered">24-mo-old English speakers</h2>
<p>Letâ€™s move on to the 24-mo-old English speakers.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>eng_24_files <span class="ot">&lt;-</span> mbcdi_file_dat <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(age_group <span class="sc">==</span> <span class="st">&#39;24&#39;</span>, lang_cond <span class="sc">==</span> <span class="st">&#39;english&#39;</span>, n_subs <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code></pre></div>
<p>There are <span class="math inline">\(n=\)</span> 3 files with participant data.</p>
<p>Letâ€™s see how the <code>clean_cdi()</code> works on one of these.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">clean_cdi</span>(eng_24_files<span class="sc">$</span>fn[<span class="dv">1</span>])</span></code></pre></div>
<p>Once again, we have duplicates for several items: â€˜candyâ€™, â€˜legâ€™, â€˜rainâ€™, â€˜wetâ€™.</p>
<p>Itâ€™s very hacky, but I think we might want to modify these item names until we figure out a better way to handle the duplicates.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>modify_mcdi_dupes <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">dupe =</span> <span class="st">&#39;leg&#39;</span>) {</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>  dup_index <span class="ot">&lt;-</span> <span class="fu">seq_along</span>(df)[<span class="fu">names</span>(df) <span class="sc">==</span> dupe]</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(dup_index)) {</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>    this_dup <span class="ot">&lt;-</span> dup_index[i]</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>    <span class="fu">names</span>(df)[this_dup] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(dupe, <span class="st">&quot;_&quot;</span>, i)</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  }</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>  df</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>}</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>open_csv <span class="ot">&lt;-</span> <span class="cf">function</span>(csv_fn) {</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>  assertthat<span class="sc">::</span><span class="fu">is.string</span>(csv_fn)</span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>  assertthat<span class="sc">::</span><span class="fu">is.readable</span>(csv_fn)</span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>  </span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a>  df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(csv_fn,</span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>                    <span class="at">col_types =</span> readr<span class="sc">::</span><span class="fu">cols</span>(<span class="at">.default =</span> <span class="st">&#39;c&#39;</span>),</span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a>                    <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a>}</span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" tabindex="-1"></a>trim_cdi_18_24_fields <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb30-20"><a href="#cb30-20" tabindex="-1"></a>  df <span class="sc">|&gt;</span></span>
<span id="cb30-21"><a href="#cb30-21" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;note&quot;</span>),</span>
<span id="cb30-22"><a href="#cb30-22" tabindex="-1"></a>                  <span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;instructions&quot;</span>),</span>
<span id="cb30-23"><a href="#cb30-23" tabindex="-1"></a>                  <span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;comments&quot;</span>),</span>
<span id="cb30-24"><a href="#cb30-24" tabindex="-1"></a>                  <span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;continue&quot;</span>),</span>
<span id="cb30-25"><a href="#cb30-25" tabindex="-1"></a>                  <span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;vocab&quot;</span>),</span>
<span id="cb30-26"><a href="#cb30-26" tabindex="-1"></a>                  <span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;mcdi&quot;</span>))</span>
<span id="cb30-27"><a href="#cb30-27" tabindex="-1"></a>}</span>
<span id="cb30-28"><a href="#cb30-28" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" tabindex="-1"></a>make_cdi_18_24_longer <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb30-30"><a href="#cb30-30" tabindex="-1"></a>  n_vars <span class="ot">&lt;-</span> <span class="fu">dim</span>(df)[<span class="dv">2</span>]</span>
<span id="cb30-31"><a href="#cb30-31" tabindex="-1"></a>  df <span class="sc">|&gt;</span></span>
<span id="cb30-32"><a href="#cb30-32" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span>n_vars,</span>
<span id="cb30-33"><a href="#cb30-33" tabindex="-1"></a>                        <span class="at">names_to =</span> <span class="st">&quot;word&quot;</span>,</span>
<span id="cb30-34"><a href="#cb30-34" tabindex="-1"></a>                        <span class="at">values_to =</span> <span class="st">&quot;knows&quot;</span>)</span>
<span id="cb30-35"><a href="#cb30-35" tabindex="-1"></a> }</span>
<span id="cb30-36"><a href="#cb30-36" tabindex="-1"></a></span>
<span id="cb30-37"><a href="#cb30-37" tabindex="-1"></a>clean_cdi_18_24_dedupe <span class="ot">&lt;-</span> <span class="cf">function</span>(csv_fn) {</span>
<span id="cb30-38"><a href="#cb30-38" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">open_csv</span>(csv_fn)</span>
<span id="cb30-39"><a href="#cb30-39" tabindex="-1"></a>  <span class="fu">names</span>(df) <span class="ot">&lt;-</span> <span class="fu">basename</span>(<span class="fu">names</span>(df))</span>
<span id="cb30-40"><a href="#cb30-40" tabindex="-1"></a>  </span>
<span id="cb30-41"><a href="#cb30-41" tabindex="-1"></a>  df <span class="sc">|&gt;</span></span>
<span id="cb30-42"><a href="#cb30-42" tabindex="-1"></a>    <span class="fu">modify_mcdi_dupes</span>(<span class="at">dupe =</span> <span class="st">&#39;leg&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-43"><a href="#cb30-43" tabindex="-1"></a>    <span class="fu">modify_mcdi_dupes</span>(<span class="at">dupe =</span> <span class="st">&#39;candy&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-44"><a href="#cb30-44" tabindex="-1"></a>    <span class="fu">modify_mcdi_dupes</span>(<span class="at">dupe =</span> <span class="st">&#39;rain&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-45"><a href="#cb30-45" tabindex="-1"></a>    <span class="fu">modify_mcdi_dupes</span>(<span class="at">dupe =</span> <span class="st">&#39;wet&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-46"><a href="#cb30-46" tabindex="-1"></a>    <span class="fu">trim_cdi_18_24_fields</span>() <span class="sc">|&gt;</span></span>
<span id="cb30-47"><a href="#cb30-47" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;play_id&quot;</span> <span class="ot">=</span> <span class="st">&quot;participant_id&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-48"><a href="#cb30-48" tabindex="-1"></a>    <span class="fu">make_cdi_18_24_longer</span>()</span>
<span id="cb30-49"><a href="#cb30-49" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>eng_24 <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(eng_24_files<span class="sc">$</span>fn, clean_cdi_18_24_dedupe) <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">list_rbind</span>()</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span> word <span class="sc">+</span> knows, eng_24)</span></code></pre></div>
<p>Now, we can return to the 18-mo-old data to see if this works:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>eng_18 <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(eng_18_files<span class="sc">$</span>fn, clean_cdi_18_24_dedupe) <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">list_rbind</span>()</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span> word <span class="sc">+</span> knows, eng_18)</span></code></pre></div>
<p>It does.</p>
</div>
</div>
<!--bookdown:body:end-->
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong></strong>" was written by . </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
