# QA for merging {-}

## Purpose {-}

This page summarizes which screening/demographics data and which home visit data have anomalies or missing data.

## Screening/demographic data {-}

```{r}
screen_df <-
  readr::read_csv(
    file.path(
      here::here(),
      "data",
      "csv",
      "screening",
      "agg",
      "PLAY-screening-datab-latest.csv"
    ),
    col_types = readr::cols(.default = 'c'),
    show_col_types = FALSE
  )
```

The following rows have incomplete or missing `site_id` values:

```{r}
screen_df |>
  dplyr::filter(is.na(site_id) | is.null(site_id)) |>
  dplyr::select(site_id, vol_id, participant_ID, play_id, group_name) |>
  dplyr::arrange(vol_id, site_id, participant_ID) |>
  knitr::kable() |>
  kableExtra::kable_classic()
```

The following rows have incomplete or missing `participant_ID` values:

```{r}
screen_df |>
  dplyr::filter(is.na(participant_ID) | is.null(participant_ID)) |>
  dplyr::select(site_id, vol_id, participant_ID, play_id, group_name) |>
  dplyr::arrange(vol_id, site_id, participant_ID) |>
  knitr::kable() |>
  kableExtra::kable_classic()
```

The following rows have incomplete or missing `play_id` values:

```{r}
screen_df |>
  dplyr::filter(is.na(play_id) | is.null(play_id)) |>
  dplyr::select(site_id, vol_id, participant_ID, play_id, group_name) |>
  dplyr::arrange(vol_id, site_id, participant_ID) |>
  knitr::kable() |>
  kableExtra::kable_classic()
```

## Home visit data {-}

```{r}
targets::tar_load(home_visit_df, store=file.path(here::here(), "_targets"))
```

The `home_visit_df` data have some field names that are inconsistent with the screening/demographic data files.
We reconcile these differences first.

```{r}
home_df <- home_visit_df |>
    dplyr::rename("play_id" = "participant_id") |>
    dplyr::rename("participant_ID" = "subject_number")
```

Since the `home_visit_df` data have not yet been merged with Databrary information, the `vol_id` and `group_name` variables are not available.

The following rows have incomplete or missing `site_id` values:

```{r}
home_df |>
  dplyr::filter(is.na(site_id) | is.null(site_id)) |>
  dplyr::select(site_id, participant_ID, play_id) |>
  dplyr::arrange(site_id, participant_ID) |>
  knitr::kable() |>
  kableExtra::kable_classic()
```

The following rows have incomplete or missing `participant_ID` values:

```{r}
home_df |>
  dplyr::filter(is.na(participant_ID) | is.null(participant_ID)) |>
  dplyr::select(site_id, participant_ID, play_id) |>
  dplyr::arrange(site_id, participant_ID) |>
  knitr::kable() |>
  kableExtra::kable_classic()
```

The following rows have incomplete or missing `play_id` values:

```{r}
home_df |>
  dplyr::filter(is.na(play_id) | is.null(play_id)) |>
  dplyr::select(site_id, participant_ID, play_id) |>
  dplyr::arrange(site_id, participant_ID) |>
  knitr::kable() |>
  kableExtra::kable_classic()
```