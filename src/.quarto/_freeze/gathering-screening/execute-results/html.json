{
  "hash": "d9c2144c22c92ee8e02839bfbba65ab8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"\"\n---\n\n\n## Collection protocol {-}\n\nDetails about the data collection [protocol for participant screening and recruiting](https://www.play-project.org/collection.html#Participant_Recruitment) can be found on the [PLAY Project website](https://play-project.org).\n\n### Setup {-}\n\nLoad functions needed to download KBT screening/demographic questionnaire files.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfl <- list.files(file.path(here::here(), \"R\"), \"^kobo_|^file_\", full.names = TRUE)\npurrr::walk(fl, source)\n```\n:::\n\n\n## Retrieve from KoBoToolbox (KBT) {-}\n\nWe make use of the `targets` package for downloading data files from KoBoToolbox\nand for saving local XLSX and CSV copies.\nThis allows us to download and process those files on a regular basis.\n\nThis excerpt from `_targets.R` shows two of these 'targets':\n\n```r\n  # Download screening/demographic survey\n  tar_target(\n    kb_screen_df,\n    kobo_list_data_filtered(kb_df, \"[Dd]emographic\"),\n    cue = tarchetypes::tar_cue_age(\n      name = kb_screen,\n      age = as.difftime(update_interval, units = update_interval_units)\n    )\n  ),\n  tar_target(\n    screen_download,\n    screen_download_convert(kb_screen_df, \"data/xlsx/screening\", \"data/csv/screening\"),\n    cue = tarchetypes::tar_cue_age(\n      name = screen_df,\n      age = as.difftime(update_interval, units = update_interval_units)\n    )\n  ),\n```\n\nThe `kb_df` data frame is input to the first target `kb_screen_df`. \n`kb_df` is generated when the following target is generated (by `kobo_list_data()`).\n\n```r\n  tar_target(\n    kb_df,\n    kobo_list_data(),\n    cue = tarchetypes::tar_cue_age(\n      name = kb_df,\n      age = as.difftime(update_interval, units = update_interval_units)\n    )\n  ),\n```\n\nThe following code shows how this works:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse) # for the `magrittr` pipe `%>%`\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nfl <-\n  list.files(\n    \"../R\",\n    \"^kobo_|^file_|^screen_|^ecbq_|^health_|^databrary|^home|^make|^export|^post_visit|CONSTANTS\",\n    full.names = TRUE\n  )\npurrr::walk(fl, source)\n\nkobo_list_data()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        id              id_string\n1   411456 a58ZhjX6M8WXtzLGvBaEaG\n2   920365 a6r99tj8RaULvzTM7MuWpi\n3   740625 a8HyzdxnVjK53dt4fX3Vup\n4  1129568 a9n2DWjJw3ayJmkijsAm7h\n5   331453 aae4wz2tpkSnAkea2PAzin\n6   363465 abYGMsrMvkGsnA4xm9kqC9\n7   363431 acCBJaRqBkSMPYdvaaWCSu\n8   334099 ad3NtS6TDPuKTUKCAyCuby\n9   363349 aEMERWLYQAdhaMKMt5QkD7\n10  307736 aeMJQLo56HWyVHkKX9oaJD\n11  334134 agChfbnGHc6fiUdfYUaZ2z\n12  346565 aGD5Q64T5zTQtakQaS8x55\n13  359546 aGLEqT7eRBhuPgizCQBeqA\n14  740631 ahYJ7XRUcit8gbFYwaxnAV\n15  361981 aJNWkgeX7c9jEFiNAgJspn\n16  738593 aJPU78BR3NfU9rm4LzRVLt\n17 1151489 aLqdPLTCZb8jvFkDxcFwzy\n18  920339 aLxPNje5yoeZijafFoVz5z\n19  738513 aM2ob4BdwFucdjjcUNTwms\n20 1136694 aMteoHisncRUStdyZfsjMB\n21  275882 anqhvxKtQieo7gc9uPqJ3y\n22  740623 aoLcmmN8KWG4N6A3XpUiRT\n23  740628 aRJW7SwKsVyZu8b4FighiM\n24  363466 asv7tL6CEYjiW2XCkLxhcX\n25  411469 aswcEAtxj24u9MfuBmS9AW\n26  740630 aThMD6zuEFjtTfptwcpZPg\n27  411388 aTyGBYk6HvRXmki9ksb29p\n28  740624 aUeYzPfq6WED4dDF28VT9D\n29  363381 aWd7wujF5d5HYaYMhT4jBZ\n30  740626 awMnFDna5kWR3LXKyGmFMd\n31  331848 axYbEbLcJxzUNFbqMVySjJ\n32  740629 axyJSgLRDeSk3BHB6cJmYk\n33  408149 ayhCy68ZTaDGc7tuGthQpJ\n34  740627 aYokcZAjTZ9JCyVXz4R5rh\n                                                                     title\n1              PLAY Home Questionaires - 12 Bilingual English (2020-03-04)\n2                                                 NYU_Pilot DLL-ES_Level_2\n3                                        PLAY_HomeQuestionaires_12_English\n4                                        Clone of NYU_Pilot DLL-ES_Level_1\n5                                    PLAY Home Questionnaires (24 English)\n6             PLAY Home Questionnaires - 24 Bilingual English (2020-03-04)\n7                       PLAY Home Questionnaires - 12 English (2020-03-04)\n8                        PLAY Home Questionnaires (12 Bilingual - English)\n9                       PLAY Home Questionnaires - 18 English (2020-03-04)\n10                                   PLAY Home Questionnaires (18 English)\n11                                PLAY Demographic Questionnaire (Spanish)\n12                                                   PLAY Post-Visit Notes\n13                                          PLAY Demographic Questionnaire\n14                             PLAY_HomeQuestionaires_24_Bilingual_English\n15                                                   PLAY Post-Visit Notes\n16                                                DLL-ES_Level_2 (English)\n17 Clone of Clone of PLAY_HomeQuestionnaires_18_English - NO AUTO METADATA\n18                                                NYU_Pilot DLL-ES_Level_1\n19                                               DLL-ES_Level_1_2021_07_30\n20             Clone of PLAY_HomeQuestionnaires_18_English - NO AUTO TODAY\n21                                          PLAY Demographic Questionnaire\n22                             PLAY_HomeQuestionaires_12_Bilingual_English\n23                                      PLAY_HomeQuestionnaires_18_English\n24            PLAY Home Questionnaires - 18 Bilingual English (2020-03-04)\n25            PLAY Home Questionnaires - 12 Bilingual Spanish (2020-03-04)\n26                             PLAY_HomeQuestionaires_24_Bilingual_Spanish\n27            PLAY Home Questionnaires - 18 Bilingual Spanish (2020-03-04)\n28                             PLAY_HomeQuestionaires_12_Bilingual_Spanish\n29                      PLAY Home Questionnaires - 24 English (2020-03-04)\n30                             PLAY_HomeQuestionaires_18_Bilingual_English\n31                                   PLAY Home Questionnaires (12 English)\n32                                      PLAY_HomeQuestionnaires_24_English\n33            PLAY Home Questionnaires - 24 Bilingual Spanish (2020-03-04)\n34                             PLAY_HomeQuestionaires_18_Bilingual_Spanish\n                                                               description\n1            PLAY Home Questionaires - 12 Bilingual (English) (2020-03-04)\n2                                                 NYU_Pilot DLL-ES_Level_2\n3                             PLAY_HomeQuestionaires_12_English-2021-07-29\n4                                        Clone of NYU_Pilot DLL-ES_Level_1\n5                                    PLAY Home Questionnaires (24 English)\n6             PLAY Home Questionnaires - 24 Bilingual English (2019-11-20)\n7                       PLAY Home Questionnaires - 12 English (2019-11-20)\n8                        PLAY Home Questionnaires (12 Bilingual - English)\n9                       PLAY Home Questionnaires - 18 English (2018-11-20)\n10                                   PLAY Home Questionnaires (18 English)\n11                                PLAY Demographic Questionnaire (Spanish)\n12                                              PLAY Cleanup Checklists v2\n13                                           New Demographic Questionnaire\n14                  PLAY_HomeQuestionaires_24_Bilingual_English-2021-07-30\n15                                      PLAY Post-Visit Notes (2019-11-18)\n16                                          DLL-ES_Level_2_KBTB_2021_07_28\n17 Clone of Clone of PLAY_HomeQuestionnaires_18_English - NO AUTO METADATA\n18                                                NYU_Pilot DLL-ES_Level_1\n19                                               DLL-ES_Level_1_2021_07_28\n20                             Clone of PLAY_HomeQuestionnaires_18_English\n21                                                PLAY Phone Questionnaire\n22                  PLAY_HomeQuestionaires_12_Bilingual_English-2021-07-29\n23                           PLAY_HomeQuestionnaires_18_English-2021-07-29\n24            PLAY Home Questionnaires - 18 Bilingual English (2019-11-20)\n25            PLAY Home Questionnaires - 12 Bilingual Spanish (2020-03-04)\n26                  PLAY_HomeQuestionaires_24_Bilingual_Spanish-2021-07-30\n27            PLAY Home Questionnaires - 18 Bilingual Spanish (2020-03-04)\n28                  PLAY_HomeQuestionaires_12_Bilingual_Spanish-2021-07-29\n29                      PLAY Home Questionnaires - 24 English (2019-11-20)\n30                  PLAY_HomeQuestionaires_18_Bilingual_English-2021-07-29\n31                                   PLAY Home Questionnaires (12 English)\n32                           PLAY_HomeQuestionnaires_24_English-2021-07-30\n33            PLAY Home Questionnaires - 24 Bilingual Spanish (2020-02-27)\n34                  PLAY_HomeQuestionaires_18_Bilingual_Spanish-2021-07-29\n                                              url\n1   https://kc.kobotoolbox.org/api/v1/data/411456\n2   https://kc.kobotoolbox.org/api/v1/data/920365\n3   https://kc.kobotoolbox.org/api/v1/data/740625\n4  https://kc.kobotoolbox.org/api/v1/data/1129568\n5   https://kc.kobotoolbox.org/api/v1/data/331453\n6   https://kc.kobotoolbox.org/api/v1/data/363465\n7   https://kc.kobotoolbox.org/api/v1/data/363431\n8   https://kc.kobotoolbox.org/api/v1/data/334099\n9   https://kc.kobotoolbox.org/api/v1/data/363349\n10  https://kc.kobotoolbox.org/api/v1/data/307736\n11  https://kc.kobotoolbox.org/api/v1/data/334134\n12  https://kc.kobotoolbox.org/api/v1/data/346565\n13  https://kc.kobotoolbox.org/api/v1/data/359546\n14  https://kc.kobotoolbox.org/api/v1/data/740631\n15  https://kc.kobotoolbox.org/api/v1/data/361981\n16  https://kc.kobotoolbox.org/api/v1/data/738593\n17 https://kc.kobotoolbox.org/api/v1/data/1151489\n18  https://kc.kobotoolbox.org/api/v1/data/920339\n19  https://kc.kobotoolbox.org/api/v1/data/738513\n20 https://kc.kobotoolbox.org/api/v1/data/1136694\n21  https://kc.kobotoolbox.org/api/v1/data/275882\n22  https://kc.kobotoolbox.org/api/v1/data/740623\n23  https://kc.kobotoolbox.org/api/v1/data/740628\n24  https://kc.kobotoolbox.org/api/v1/data/363466\n25  https://kc.kobotoolbox.org/api/v1/data/411469\n26  https://kc.kobotoolbox.org/api/v1/data/740630\n27  https://kc.kobotoolbox.org/api/v1/data/411388\n28  https://kc.kobotoolbox.org/api/v1/data/740624\n29  https://kc.kobotoolbox.org/api/v1/data/363381\n30  https://kc.kobotoolbox.org/api/v1/data/740626\n31  https://kc.kobotoolbox.org/api/v1/data/331848\n32  https://kc.kobotoolbox.org/api/v1/data/740629\n33  https://kc.kobotoolbox.org/api/v1/data/408149\n34  https://kc.kobotoolbox.org/api/v1/data/740627\n                                                              form_url\n1  https://kf.kobotoolbox.org/api/v2/assets/a58ZhjX6M8WXtzLGvBaEaG.xls\n2  https://kf.kobotoolbox.org/api/v2/assets/a6r99tj8RaULvzTM7MuWpi.xls\n3  https://kf.kobotoolbox.org/api/v2/assets/a8HyzdxnVjK53dt4fX3Vup.xls\n4  https://kf.kobotoolbox.org/api/v2/assets/a9n2DWjJw3ayJmkijsAm7h.xls\n5  https://kf.kobotoolbox.org/api/v2/assets/aae4wz2tpkSnAkea2PAzin.xls\n6  https://kf.kobotoolbox.org/api/v2/assets/abYGMsrMvkGsnA4xm9kqC9.xls\n7  https://kf.kobotoolbox.org/api/v2/assets/acCBJaRqBkSMPYdvaaWCSu.xls\n8  https://kf.kobotoolbox.org/api/v2/assets/ad3NtS6TDPuKTUKCAyCuby.xls\n9  https://kf.kobotoolbox.org/api/v2/assets/aEMERWLYQAdhaMKMt5QkD7.xls\n10 https://kf.kobotoolbox.org/api/v2/assets/aeMJQLo56HWyVHkKX9oaJD.xls\n11 https://kf.kobotoolbox.org/api/v2/assets/agChfbnGHc6fiUdfYUaZ2z.xls\n12 https://kf.kobotoolbox.org/api/v2/assets/aGD5Q64T5zTQtakQaS8x55.xls\n13 https://kf.kobotoolbox.org/api/v2/assets/aGLEqT7eRBhuPgizCQBeqA.xls\n14 https://kf.kobotoolbox.org/api/v2/assets/ahYJ7XRUcit8gbFYwaxnAV.xls\n15 https://kf.kobotoolbox.org/api/v2/assets/aJNWkgeX7c9jEFiNAgJspn.xls\n16 https://kf.kobotoolbox.org/api/v2/assets/aJPU78BR3NfU9rm4LzRVLt.xls\n17 https://kf.kobotoolbox.org/api/v2/assets/aLqdPLTCZb8jvFkDxcFwzy.xls\n18 https://kf.kobotoolbox.org/api/v2/assets/aLxPNje5yoeZijafFoVz5z.xls\n19 https://kf.kobotoolbox.org/api/v2/assets/aM2ob4BdwFucdjjcUNTwms.xls\n20 https://kf.kobotoolbox.org/api/v2/assets/aMteoHisncRUStdyZfsjMB.xls\n21 https://kf.kobotoolbox.org/api/v2/assets/anqhvxKtQieo7gc9uPqJ3y.xls\n22 https://kf.kobotoolbox.org/api/v2/assets/aoLcmmN8KWG4N6A3XpUiRT.xls\n23 https://kf.kobotoolbox.org/api/v2/assets/aRJW7SwKsVyZu8b4FighiM.xls\n24 https://kf.kobotoolbox.org/api/v2/assets/asv7tL6CEYjiW2XCkLxhcX.xls\n25 https://kf.kobotoolbox.org/api/v2/assets/aswcEAtxj24u9MfuBmS9AW.xls\n26 https://kf.kobotoolbox.org/api/v2/assets/aThMD6zuEFjtTfptwcpZPg.xls\n27 https://kf.kobotoolbox.org/api/v2/assets/aTyGBYk6HvRXmki9ksb29p.xls\n28 https://kf.kobotoolbox.org/api/v2/assets/aUeYzPfq6WED4dDF28VT9D.xls\n29 https://kf.kobotoolbox.org/api/v2/assets/aWd7wujF5d5HYaYMhT4jBZ.xls\n30 https://kf.kobotoolbox.org/api/v2/assets/awMnFDna5kWR3LXKyGmFMd.xls\n31 https://kf.kobotoolbox.org/api/v2/assets/axYbEbLcJxzUNFbqMVySjJ.xls\n32 https://kf.kobotoolbox.org/api/v2/assets/axyJSgLRDeSk3BHB6cJmYk.xls\n33 https://kf.kobotoolbox.org/api/v2/assets/ayhCy68ZTaDGc7tuGthQpJ.xls\n34 https://kf.kobotoolbox.org/api/v2/assets/aYokcZAjTZ9JCyVXz4R5rh.xls\n```\n\n\n:::\n:::\n\n\n\n<!-- ### Download {-} -->\n\n<!-- We have two targets specified in `_targets.R` that handle the regular downloading of screening data files. -->\n\n<!-- First, we generate a data frame of KoBoToolbox forms that contain the screening (\"Demographic\") data. -->\n<!-- Here is the target for that process: -->\n\n<!-- ``` -->\n<!-- # Not evaluated -->\n<!--   tar_target( -->\n<!--     kb_screen_df, -->\n<!--     kobo_list_data_filtered(\"[Dd]emographic\"), -->\n<!--     cue = tarchetypes::tar_cue_age( -->\n<!--       name = kb_screen, -->\n<!--       age = as.difftime(update_interval, units = update_interval_units) -->\n<!--     ) -->\n<!--   ), -->\n<!-- ``` -->\n\n<!-- Then we download and save the raw XLSX files to `../data/xlsx/screening` using `kobo_retrieve_save_many_xlsx(kb_screen_df, save_dir = \"../data/xlsx/screening\")`. -->\n<!-- Finally, we convert the XLSX files to CSVs via `file_load_xlsx_save_many_csv(\"../data/xlsx/screening\", \"../data/csv/screening\", \"Demographic\")`. -->\n<!-- The latter two steps are handled by the wrapper function `screen_download_convert(kb_screen_df, \"data/xlsx/screening\", \"data/csv/screening\")`. -->\n<!-- Here is the accompanying target: -->\n\n<!-- ``` -->\n<!-- # Download screening/demographic survey -->\n<!--   tar_target( -->\n<!--     screen_download, -->\n<!--     screen_download_convert(kb_screen_df, \"data/xlsx/screening\", \"data/csv/screening\"), -->\n<!--     cue = tarchetypes::tar_cue_age( -->\n<!--       name = screen_df, -->\n<!--       age = as.difftime(update_interval, units = update_interval_units) -->\n<!--     ) -->\n<!--   ), -->\n<!-- ``` -->\n\n#### Survey questions\n\nThe form for the survey questions can be downloaded from the following URL:\n\n<https://kf.kobotoolbox.org/api/v2/assets/aGLEqT7eRBhuPgizCQBeqA.xls>\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}