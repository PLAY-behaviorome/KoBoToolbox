{
  "hash": "b33a80caab465b1744525fdf47e769cd",
  "result": {
    "engine": "knitr",
    "markdown": "# Home visit: Cleaning\n\n## Setup\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressPackageStartupMessages(library(\"tidyverse\"))\n```\n:::\n\n\n\n\n\n\n## Remove identifiers {-}\n\nThe function `remove_identifiers()` in `R/kobo_export` detects the presence of names, addresses, phone numbers, email, and dates in the field names for an input file and removes these fields.\nIt also modifies the file name by appending `_deidentified`.\n\nThe `remove_identifiers()` function detects these fields\nFor clarity, we print it here.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsource(\"~/rrr/KoBoToolbox/R/_OLD/functions.R\", echo = FALSE, print.eval = FALSE)\nremove_identifiers\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nfunction (df) \n{\n    require(stringr)\n    stopifnot(is.data.frame(df))\n    contains_name <- stringr::str_detect(names(df), \"name\")\n    contains_address <- stringr::str_detect(names(df), \"address\")\n    contains_phone <- stringr::str_detect(names(df), \"phone\")\n    contains_email <- stringr::str_detect(names(df), \"email\")\n    contains_birthdate <- stringr::str_detect(names(df), \"birthdate\")\n    contains_first <- stringr::str_detect(names(df), \"first[12]?\")\n    contains_last <- stringr::str_detect(names(df), \"last[12]?\")\n    contains_city <- stringr::str_detect(names(df), \"city\")\n    contains_year <- stringr::str_detect(names(df), \"year[12]?\")\n    contains_month <- stringr::str_detect(names(df), \"month[12]?\")\n    contains_day <- stringr::str_detect(names(df), \"/day[12]?$\")\n    identifiable_data <- contains_name | contains_address | contains_phone | \n        contains_email | contains_birthdate | contains_first | \n        contains_last | contains_city | contains_year | contains_month | \n        contains_day\n    identifiable_cols <- (1:length(names(df)))[identifiable_data]\n    df_deidentified <- df %>% dplyr::select(., -all_of(identifiable_cols))\n    df_deidentified\n}\n```\n\n\n:::\n:::\n\n\n\n\n\nThe **non-MBCDI file** contains the identifiers, so that is the target of this removal process.\n\n::: {.rmdnote}\nNote that we have added `data` to `.gitignore` in `protocol/`, the root directory for the HTML protocol, so *none* of the data files should be made available via git or GitHub. This also means that there is **no version control** being done on raw data files themselves.\n:::\n\n```\ntar_target(\n  home_visit_remove_identifiers,\n  purrr::map_chr(\n    home_visit_non_mbcdi,\n    open_deidentify_save,\n    csv_save_dir = \"data/csv/home_visit/non_mbcdi/deid\",\n      these_questions = 'non_mbcdi'\n  )\n)\n```\n\n## Quality assurance (QA) reviews {-}\n\n### MB-CDI files {-}\n\n::: {.callout-note}\n\nTo be completed.\n\n:::\n\n### Non-MB-CDI files {-}\n\nCreate a helper function to create a data set with summary information about the data files.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummarize_non_mbcdi_qs <- function(fn) {\n  stopifnot(is.character(fn))\n  \n  if (!file.exists(fn)) {\n    stop('File not found `', fn, '`')\n  } else {\n    df <- readr::read_csv(fn, show_col_types = FALSE)\n    if (!is.data.frame(df)) {\n      stop('Error reading data frame')\n    } else {\n      out_df <-\n        tibble(\n          file_name = basename(fn),\n          n_rows = dim(df)[1],\n          n_vars = dim(df)[2]\n        )\n      dplyr::arrange(out_df, file_name)\n    }\n  }\n}\n```\n:::\n\n\n\n\n\nSelect the de-identified CSVs to examine.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfl <-\n  list.files(\n    file.path(\"../data/csv/home_visit/non_mbcdi/deid\"),\n    '^[0-9]+_non_mbcdi_[12|18|24].*deidentified',\n    full.names = TRUE\n  )\n\nPLAY_forms <- purrr::map_df(fl, summarize_non_mbcdi_qs)\n\nPLAY_forms %>%\n  knitr::kable(., format = 'html') %>%\n  kableExtra::kable_classic()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> file_name </th>\n   <th style=\"text-align:right;\"> n_rows </th>\n   <th style=\"text-align:right;\"> n_vars </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1136694_non_mbcdi_18_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 288 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1151489_non_mbcdi_18_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 286 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 307736_non_mbcdi_18_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 274 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 331453_non_mbcdi_24_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 274 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 331848_non_mbcdi_12_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 267 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 334099_non_mbcdi_12_bilingual_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 267 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 363349_non_mbcdi_18_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 280 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 363381_non_mbcdi_24_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 280 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 363431_non_mbcdi_12_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 281 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 363465_non_mbcdi_24_bilingual_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 280 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 363466_non_mbcdi_18_bilingual_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 280 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 408149_non_mbcdi_24_bilingual_spanish_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 280 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 411388_non_mbcdi_18_bilingual_spanish_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 280 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 411456_non_mbcdi_12_bilingual_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 280 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 411469_non_mbcdi_12_bilingual_spanish_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 280 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 740623_non_mbcdi_12_bilingual_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 42 </td>\n   <td style=\"text-align:right;\"> 288 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 740624_non_mbcdi_12_bilingual_spanish_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 288 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 740625_non_mbcdi_12_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 218 </td>\n   <td style=\"text-align:right;\"> 288 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 740626_non_mbcdi_18_bilingual_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 287 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 740627_non_mbcdi_18_bilingual_spanish_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 287 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 740628_non_mbcdi_18_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 205 </td>\n   <td style=\"text-align:right;\"> 288 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 740629_non_mbcdi_24_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 170 </td>\n   <td style=\"text-align:right;\"> 287 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 740630_non_mbcdi_24_bilingual_spanish_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 287 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 740631_non_mbcdi_24_bilingual_english_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 44 </td>\n   <td style=\"text-align:right;\"> 287 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 740631_non_mbcdi_24_bilingual_spanish_deidentified.csv </td>\n   <td style=\"text-align:right;\"> 26 </td>\n   <td style=\"text-align:right;\"> 287 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n\nThe later forms (with higher form numbers--the leading integers in the file names) are the newer ones.\nThese generally have the largest number of entries and have similar numbers of columns--either 287 or 288.\nAccordingly, we focus our cleaning efforts here first.\n\nWe start with the data files that have $n=288$ columns.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf740623 <-\n  readr::read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/740623_non_mbcdi_12_bilingual_english_deidentified.csv\",\n    show_col_types = FALSE\n  )\n\ndf740624 <-\n  readr::read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/740624_non_mbcdi_12_bilingual_spanish_deidentified.csv\",\n    show_col_types = FALSE\n  )\n\nsum(names(df740623) == names(df740624))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 288\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf740625 <-\n  readr::read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/740625_non_mbcdi_12_english_deidentified.csv\",\n    show_col_types = FALSE\n  )\n\nsum(names(df740623) == names(df740625))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 288\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf740628 <-\n  readr::read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/740628_non_mbcdi_18_english_deidentified.csv\",\n    show_col_types = FALSE\n  )\n\nsum(names(df740623) == names(df740628))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 288\n```\n\n\n:::\n:::\n\n\n\n\n\nSo, four of the most recent data files with $n=288$ columns can be aggregated without modification.\n\nLet's turn to the more recent files with $n=287$ columns.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf740626 <-\n  readr::read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/740626_non_mbcdi_18_bilingual_english_deidentified.csv\",\n    show_col_types = FALSE\n  )\n\ndf740627 <-\n  readr::read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/740627_non_mbcdi_18_bilingual_spanish_deidentified.csv\",\n    show_col_types = FALSE\n  )\n\nsum(names(df740626) == names(df740627))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 100\n```\n\n\n:::\n:::\n\n\n\n\n\nWhere does the misalignment arise?\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(df740626) == names(df740627)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [25]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [37]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [49]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [61]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [73]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [85]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE\n [97] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[109] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[121] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[133] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[145] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[157] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[169] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[181] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[193] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[205] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[217] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[229] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[241] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[253] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[265] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[277] FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n```\n\n\n:::\n:::\n\n\n\n\n\nThe misalignment arises somewhere near column 92.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf740629 <-\n  readr::read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/740629_non_mbcdi_24_english_deidentified.csv\",\n    show_col_types = FALSE\n  )\n\nsum(names(df740626) == names(df740629))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 287\n```\n\n\n:::\n:::\n\n\n\n\n\nSo, `df740626` and `df740629` are aligned and can be merged.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf740630 <-\n  readr::read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/740630_non_mbcdi_24_bilingual_spanish_deidentified.csv\",\n    show_col_types = FALSE\n  )\n\nsum(names(df740626) == names(df740630))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 100\n```\n\n\n:::\n\n```{.r .cell-code}\nnames(df740626) == names(df740630)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [25]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [37]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [49]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [61]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [73]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [85]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE\n [97] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[109] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[121] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[133] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[145] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[157] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[169] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[181] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[193] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[205] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[217] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[229] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[241] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[253] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[265] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[277] FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n```\n\n\n:::\n:::\n\n\n\n\n\nThese files also fall out of alignment near column 92.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf740631 <-\n  readr::read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/740631_non_mbcdi_24_bilingual_english_deidentified.csv\",\n    show_col_types = FALSE\n  )\n\nsum(names(df740626) == names(df740631))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 100\n```\n\n\n:::\n\n```{.r .cell-code}\nnames(df740626) == names(df740631)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [25]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [37]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [49]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [61]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [73]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [85]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE\n [97] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[109] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[121] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[133] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[145] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[157] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[169] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[181] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[193] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[205] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[217] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[229] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[241] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[253] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[265] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[277] FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n```\n\n\n:::\n:::\n\n\n\n\n\nAnd these files fall out of alignment near column 92.\n\nLet's see if `df740627`, `df740630`, and `df740631` are aligned with one another.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(names(df740627) == names(df740630))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 287\n```\n\n\n:::\n\n```{.r .cell-code}\nsum(names(df740627) == names(df740631))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 287\n```\n\n\n:::\n:::\n\n\n\n\n\nYes, they are. So, these three can be merged. \nWe do that first, then address the discrepancies between aggregates.\n\n### 'Older' forms {-}\n\nThe \"older\" forms have varied numbers of columns.\nWe focus on thos with data (n_vars > 0)\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf307736 <-\n  read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/307736_non_mbcdi_18_english_deidentified.csv\",\n    show_col_types = FALSE\n  )\ndf331453 <-\n  read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/331453_non_mbcdi_24_english_deidentified.csv\",\n    show_col_types = FALSE\n  )\ndf331848 <-\n  read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/331848_non_mbcdi_12_english_deidentified.csv\",\n    show_col_types = FALSE\n  )\ndf334099 <-\n  read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/334099_non_mbcdi_12_bilingual_english_deidentified.csv\",\n    show_col_types = FALSE\n  )\ndf363349 <-\n  read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/363349_non_mbcdi_18_english_deidentified.csv\",\n    show_col_types = FALSE\n  )\ndf363381 <-\n  read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/363381_non_mbcdi_24_english_deidentified.csv\",\n    show_col_types = FALSE\n  )\ndf363431 <-\n  read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/363431_non_mbcdi_12_english_deidentified.csv\",\n    show_col_types = FALSE\n  )\ndf408149 <-\n  read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/408149_non_mbcdi_24_bilingual_spanish_deidentified.csv\",\n    show_col_types = FALSE\n  )\ndf411456 <-\n  read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/411456_non_mbcdi_12_bilingual_english_deidentified.csv\",\n    show_col_types = FALSE\n  )\ndf411469 <-\n  read_csv(\n    \"../data/csv/home_visit/non_mbcdi/deid/411469_non_mbcdi_12_bilingual_spanish_deidentified.csv\",\n    show_col_types = FALSE\n  )\n```\n:::\n\n\n\n\n\nLet's look at the two forms that have the same number of columns, $n=274$, 307736 and 331453.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(df307736) == names(df331453)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [16] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [31] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [46] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [61] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [76] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [91] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[106] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[121] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[136] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[151] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[166] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[181] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[196] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[211] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[226] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[241] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[256] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[271] TRUE TRUE TRUE TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nlength(names(df307736) == names(df331453)) == length(names(df307736))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n:::\n\n\n\n\nSo, these two are identical and could be merged.\n\n```\ntar_target(files_274_cols, stringr::str_detect(home_visit_remove_identifiers, \"/(307736|331453)\"))\n\ntar_target(df_merge_274_cols, make_aggregate_data_file(home_visit_remove_identifiers[files_274_cols]))\n```\n\nHow about the files with $n=267$ columns, 331848 and 334099?\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(df331848) == names(df334099)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [13] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [37] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [49] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [61] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [73] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [85] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [97] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[109] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[121] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[133] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[145] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[157] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[169] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[181] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[193] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[205] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[217] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[229] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[241] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[253] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[265]  TRUE  TRUE  TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nlength(names(df331848) == names(df334099)) == length(names(df331848))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(df331848) |> head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"group_combinedquestionnaires/participant_id\"             \n[2] \"start\"                                                   \n[3] \"end\"                                                     \n[4] \"group_combinedquestionnaires/note_fillthisoutbeforestudy\"\n[5] \"group_combinedquestionnaires/site_id\"                    \n[6] \"group_combinedquestionnaires/subject_number\"             \n```\n\n\n:::\n\n```{.r .cell-code}\nnames(df334099) |> head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"group_jo84c13/participant_id\"             \n[2] \"start\"                                    \n[3] \"end\"                                      \n[4] \"group_jo84c13/note_fillthisoutbeforestudy\"\n[5] \"group_jo84c13/site_id\"                    \n[6] \"group_jo84c13/subject_number\"             \n```\n\n\n:::\n:::\n\n\n\n\nThere is an odd difference in the group label, `group_combinedquestionnaires` vs. `group_jo84c13`.\n\nLet's try deleting the initial group labels and compare again.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn1 <- names(df331848)\nn2 <- names(df334099)\n\nnames(df331848) %>% stringr::str_remove(\"group_combinedquestionnaires/\") |> head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"participant_id\"              \"start\"                      \n[3] \"end\"                         \"note_fillthisoutbeforestudy\"\n[5] \"site_id\"                     \"subject_number\"             \n```\n\n\n:::\n\n```{.r .cell-code}\nnames(df334099) %>% stringr::str_remove(\"group_jo84c13/\") |> head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"participant_id\"              \"start\"                      \n[3] \"end\"                         \"note_fillthisoutbeforestudy\"\n[5] \"site_id\"                     \"subject_number\"             \n```\n\n\n:::\n:::\n\n\n\n\n\nThat looks promising.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(df331848) %>% stringr::str_remove(\"group_combinedquestionnaires/\") -> n1\nnames(df334099) %>% stringr::str_remove(\"group_jo84c13/\") -> n2\nn1 == n2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE\n [13] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [37] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [49] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [61] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [73] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [85] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [97] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[109] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[121] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[133] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[145] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[157] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[169] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[181] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[193] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[205] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[217] FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE\n[229] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[241] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[253] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[265]  TRUE  TRUE  TRUE\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncbind(n1[8:15], n2[8:15])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     [,1]                     [,2]                    \n[1,] \"test_date\"              \"test_date\"             \n[2,] \"child_sex\"              \"child_birth_date\"      \n[3,] \"age_group\"              \"child_sex\"             \n[4,] \"language_child\"         \"age_group\"             \n[5,] \"language_child/english\" \"language_child\"        \n[6,] \"language_child/spanish\" \"language_child/english\"\n[7,] \"language_instruction\"   \"language_child/spanish\"\n[8,] \"acknowledge_site\"       \"language_instruction\"  \n```\n\n\n:::\n:::\n\n\n\n\n\n`n2` or `df334099` has a `child_birth_date` field in position 9 that the other data frame does not have.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn1 |> str_detect(\"child_birth_date\") |> sum()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n\n\n\n\nIf we delete that variable, the data frames will no longer have the same number of columns.\nLet's explore that anyway.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn2_2 <- n2[-9]\n\nn1 == n2_2\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in n1 == n2_2: longer object length is not a multiple of shorter object\nlength\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [25]  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE  TRUE FALSE FALSE\n [37]  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [49] FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [61]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [73] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [85] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [97] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[109] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[121] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[133] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[145] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[157] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[169] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[181] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[193] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[205] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[217] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE\n[229] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[241] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[253] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[265] FALSE FALSE FALSE\n```\n\n\n:::\n:::\n\n\n\n\n\nThat helps a bit, but we diverge around column 29.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncbind(n1[28:51], n2_2[28:51])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      [,1]                                                                                                \n [1,] \"group_homevisitquestionnaires/group_health/group_general_health/child_hearing_tested\"              \n [2,] \"group_homevisitquestionnaires/group_health/group_general_health/child_hearing_tested/birthhospital\"\n [3,] \"group_homevisitquestionnaires/group_health/group_general_health/child_hearing_tested/afterhome\"    \n [4,] \"group_homevisitquestionnaires/group_health/group_general_health/child_hearing_tested/no\"           \n [5,] \"group_homevisitquestionnaires/group_health/group_general_health/child_hearing_tested/refused\"      \n [6,] \"group_homevisitquestionnaires/group_health/group_general_health/child_hearing_tested/donotknow\"    \n [7,] \"group_homevisitquestionnaires/group_health/group_general_health/child_vision_tested\"               \n [8,] \"group_homevisitquestionnaires/group_health/group_general_health/child_vision_tested/birthhospital\" \n [9,] \"group_homevisitquestionnaires/group_health/group_general_health/child_vision_tested/afterhome\"     \n[10,] \"group_homevisitquestionnaires/group_health/group_general_health/child_vision_tested/no\"            \n[11,] \"group_homevisitquestionnaires/group_health/group_general_health/child_vision_tested/refused\"       \n[12,] \"group_homevisitquestionnaires/group_health/group_general_health/child_vision_tested/donotknow\"     \n[13,] \"group_homevisitquestionnaires/group_health/group_general_health/group_medicalprof/allergies\"       \n[14,] \"group_homevisitquestionnaires/group_health/group_general_health/group_medicalprof/ear_infection\"   \n[15,] \"group_homevisitquestionnaires/group_health/group_general_health/group_medicalprof/asthma\"          \n[16,] \"group_homevisitquestionnaires/group_health/group_general_health/group_medicalprof/respiratory\"     \n[17,] \"group_homevisitquestionnaires/group_health/group_general_health/group_medicalprof/gastrointestinal\"\n[18,] \"group_homevisitquestionnaires/group_health/group_general_health/comments_allergy_etc\"              \n[19,] \"group_homevisitquestionnaires/group_health/group_general_health/child_injury_times\"                \n[20,] \"group_homevisitquestionnaires/group_health/group_general_health/comment_injury\"                    \n[21,] \"group_homevisitquestionnaires/group_health/group_general_health/comments_general_health\"           \n[22,] \"group_homevisitquestionnaires/group_health/group_prenatal/instructions_prenatal\"                   \n[23,] \"group_homevisitquestionnaires/group_health/group_prenatal/prenatal_care\"                           \n[24,] \"group_homevisitquestionnaires/group_health/group_prenatal/comments_prenatal\"                       \n      [,2]                                                                                                                                  \n [1,] \"group_homevisitquestionnaires/group_health/group_general_health/child_hearing_tested\"                                                \n [2,] \"group_homevisitquestionnaires/group_health/group_general_health/child_hearing_tested/yes__in_the_bi\"                                 \n [3,] \"group_homevisitquestionnaires/group_health/group_general_health/child_hearing_tested/yes__after_goi\"                                 \n [4,] \"group_homevisitquestionnaires/group_health/group_general_health/child_hearing_tested/no\"                                             \n [5,] \"group_homevisitquestionnaires/group_health/group_general_health/child_hearing_tested/refused\"                                        \n [6,] \"group_homevisitquestionnaires/group_health/group_general_health/child_hearing_tested/don_t_know\"                                     \n [7,] \"group_homevisitquestionnaires/group_health/group_general_health/child_vision_tested\"                                                 \n [8,] \"group_homevisitquestionnaires/group_health/group_general_health/child_vision_tested/yes__in_the_bi\"                                  \n [9,] \"group_homevisitquestionnaires/group_health/group_general_health/child_vision_tested/yes__after_goi\"                                  \n[10,] \"group_homevisitquestionnaires/group_health/group_general_health/child_vision_tested/no\"                                              \n[11,] \"group_homevisitquestionnaires/group_health/group_general_health/child_vision_tested/refused\"                                         \n[12,] \"group_homevisitquestionnaires/group_health/group_general_health/child_vision_tested/don_t_know\"                                      \n[13,] \"group_homevisitquestionnaires/group_health/group_general_health/child_allergies_infections_ill/child_allergies_infections_ill_header\"\n[14,] \"group_homevisitquestionnaires/group_health/group_general_health/child_allergies_infections_ill/allergies\"                            \n[15,] \"group_homevisitquestionnaires/group_health/group_general_health/child_allergies_infections_ill/ear_infection\"                        \n[16,] \"group_homevisitquestionnaires/group_health/group_general_health/child_allergies_infections_ill/asthma\"                               \n[17,] \"group_homevisitquestionnaires/group_health/group_general_health/child_allergies_infections_ill/respiratory\"                          \n[18,] \"group_homevisitquestionnaires/group_health/group_general_health/child_allergies_infections_ill/gastrointestinal\"                     \n[19,] \"group_homevisitquestionnaires/group_health/group_general_health/comments_allergy_etc\"                                                \n[20,] \"group_homevisitquestionnaires/group_health/group_general_health/child_injury_times\"                                                  \n[21,] \"group_homevisitquestionnaires/group_health/group_general_health/comment_injury\"                                                      \n[22,] \"group_homevisitquestionnaires/group_health/group_general_health/comments_general_health\"                                             \n[23,] \"group_homevisitquestionnaires/group_health/group_prenatal/instructions_prenatal\"                                                     \n[24,] \"group_homevisitquestionnaires/group_health/group_prenatal/comments_prenatal\"                                                         \n```\n\n\n:::\n:::\n\n\n\n\n\nThese question labels looks very similar.\nThere are just some minor changes in the variable names.\n`n2_2` has an extra variable in column 40.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn2_3 <- n2_2[-40]\n```\n:::\n\n\n\n\n\nThen, we can rename some of the columns in `n2_3` using corresponding names from `n1`.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn2_3 |> stringr::str_replace(\"yes__in_the_bi\", \"birthhospital\") |> stringr::str_replace(\"yes__after_goi\", \"afterhome\") |> stringr::str_replace(\"don_t_know\", \"donotknow\") -> n2_4\n\nn1 == n2_4\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in n1 == n2_4: longer object length is not a multiple of shorter object\nlength\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [25]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [37]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE\n [49]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [61] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [73] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [85] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [97] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[109] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[121] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[133] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[145] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[157] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[169] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[181] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[193] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[205] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[217] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE\n[229]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[241] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[253] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[265] FALSE FALSE FALSE\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncbind(n1[39:51], n2_4[39:51])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      [,1]                                                                                                \n [1,] \"group_homevisitquestionnaires/group_health/group_general_health/child_vision_tested/donotknow\"     \n [2,] \"group_homevisitquestionnaires/group_health/group_general_health/group_medicalprof/allergies\"       \n [3,] \"group_homevisitquestionnaires/group_health/group_general_health/group_medicalprof/ear_infection\"   \n [4,] \"group_homevisitquestionnaires/group_health/group_general_health/group_medicalprof/asthma\"          \n [5,] \"group_homevisitquestionnaires/group_health/group_general_health/group_medicalprof/respiratory\"     \n [6,] \"group_homevisitquestionnaires/group_health/group_general_health/group_medicalprof/gastrointestinal\"\n [7,] \"group_homevisitquestionnaires/group_health/group_general_health/comments_allergy_etc\"              \n [8,] \"group_homevisitquestionnaires/group_health/group_general_health/child_injury_times\"                \n [9,] \"group_homevisitquestionnaires/group_health/group_general_health/comment_injury\"                    \n[10,] \"group_homevisitquestionnaires/group_health/group_general_health/comments_general_health\"           \n[11,] \"group_homevisitquestionnaires/group_health/group_prenatal/instructions_prenatal\"                   \n[12,] \"group_homevisitquestionnaires/group_health/group_prenatal/prenatal_care\"                           \n[13,] \"group_homevisitquestionnaires/group_health/group_prenatal/comments_prenatal\"                       \n      [,2]                                                                                                             \n [1,] \"group_homevisitquestionnaires/group_health/group_general_health/child_vision_tested/donotknow\"                  \n [2,] \"group_homevisitquestionnaires/group_health/group_general_health/child_allergies_infections_ill/allergies\"       \n [3,] \"group_homevisitquestionnaires/group_health/group_general_health/child_allergies_infections_ill/ear_infection\"   \n [4,] \"group_homevisitquestionnaires/group_health/group_general_health/child_allergies_infections_ill/asthma\"          \n [5,] \"group_homevisitquestionnaires/group_health/group_general_health/child_allergies_infections_ill/respiratory\"     \n [6,] \"group_homevisitquestionnaires/group_health/group_general_health/child_allergies_infections_ill/gastrointestinal\"\n [7,] \"group_homevisitquestionnaires/group_health/group_general_health/comments_allergy_etc\"                           \n [8,] \"group_homevisitquestionnaires/group_health/group_general_health/child_injury_times\"                             \n [9,] \"group_homevisitquestionnaires/group_health/group_general_health/comment_injury\"                                 \n[10,] \"group_homevisitquestionnaires/group_health/group_general_health/comments_general_health\"                        \n[11,] \"group_homevisitquestionnaires/group_health/group_prenatal/instructions_prenatal\"                                \n[12,] \"group_homevisitquestionnaires/group_health/group_prenatal/comments_prenatal\"                                    \n[13,] \"group_homevisitquestionnaires/group_health/group_smoking/pregnant_smoking\"                                      \n```\n\n\n:::\n:::\n\n\n\n\n\n`n1` has a `group_medicalprof` label from `allergies` through `gastrointestinal`; `n2_4` has `child_allergies_infections_ill` for the same questions.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn2_4 |> stringr::str_replace(\"child_allergies_infections_ill\", \"group_medicalprof\") -> n2_5\nn1 == n2_5\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in n1 == n2_5: longer object length is not a multiple of shorter object\nlength\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [25]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [37]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [49]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [61] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [73] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [85] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [97] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[109] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[121] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[133] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[145] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[157] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[169] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[181] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[193] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[205] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[217] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE\n[229]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[241] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[253] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[265] FALSE FALSE FALSE\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncbind(n1[49:60], n2_5[49:60])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      [,1]                                                                             \n [1,] \"group_homevisitquestionnaires/group_health/group_prenatal/instructions_prenatal\"\n [2,] \"group_homevisitquestionnaires/group_health/group_prenatal/prenatal_care\"        \n [3,] \"group_homevisitquestionnaires/group_health/group_prenatal/comments_prenatal\"    \n [4,] \"group_homevisitquestionnaires/group_health/group_smoking/pregnant_smoking\"      \n [5,] \"group_homevisitquestionnaires/group_health/group_smoking/smoking_trimester_1\"   \n [6,] \"group_homevisitquestionnaires/group_health/group_smoking/smoking_trimester_2\"   \n [7,] \"group_homevisitquestionnaires/group_health/group_smoking/smoking_trimester_3\"   \n [8,] \"group_homevisitquestionnaires/group_health/group_smoking/mom_smoking_now\"       \n [9,] \"group_homevisitquestionnaires/group_health/group_smoking/mom_smoking_now_amount\"\n[10,] \"group_homevisitquestionnaires/group_health/group_smoking/smoking_house\"         \n[11,] \"group_homevisitquestionnaires/group_health/group_smoking/smoking_car\"           \n[12,] \"group_homevisitquestionnaires/group_health/group_smoking/comments_smoking\"      \n      [,2]                                                                             \n [1,] \"group_homevisitquestionnaires/group_health/group_prenatal/instructions_prenatal\"\n [2,] \"group_homevisitquestionnaires/group_health/group_prenatal/comments_prenatal\"    \n [3,] \"group_homevisitquestionnaires/group_health/group_smoking/pregnant_smoking\"      \n [4,] \"group_homevisitquestionnaires/group_health/group_smoking/smoking_trimester_1\"   \n [5,] \"group_homevisitquestionnaires/group_health/group_smoking/smoking_trimester_2\"   \n [6,] \"group_homevisitquestionnaires/group_health/group_smoking/smoking_trimester_3\"   \n [7,] \"group_homevisitquestionnaires/group_health/group_smoking/mom_smoking_now\"       \n [8,] \"group_homevisitquestionnaires/group_health/group_smoking/mom_smoking_now_amount\"\n [9,] \"group_homevisitquestionnaires/group_health/group_smoking/smoking_house\"         \n[10,] \"group_homevisitquestionnaires/group_health/group_smoking/smoking_car\"           \n[11,] \"group_homevisitquestionnaires/group_health/group_smoking/comments_smoking\"      \n[12,] \"group_homevisitquestionnaires/group_health/group_drinking/pregnant_drinking\"    \n```\n\n\n:::\n:::\n\n\n\n\n\nIt looks like these could be reconciled by deleting `prenatal_care` from `n1`.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn1_2 <- n1[-50]\nn1_2 == n2_5\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in n1_2 == n2_5: longer object length is not a multiple of shorter\nobject length\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [25]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [37]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [49]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [61]  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [73] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [85] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [97] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[109] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[121] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[133] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[145] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[157] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[169] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[181] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[193] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[205] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[217] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE\n[229] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[241] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[253] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[265] FALSE FALSE\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncbind(n1_2[64:75], n2_5[64:75])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      [,1]                                                                                                          \n [1,] \"group_homevisitquestionnaires/group_health/group_drinking/comments_drinking\"                                 \n [2,] \"group_homevisitquestionnaires/group_health/group_phq4/note_phq4\"                                             \n [3,] \"group_homevisitquestionnaires/group_health/group_phq4/group_phq4_001/phq4_nervous\"                           \n [4,] \"group_homevisitquestionnaires/group_health/group_phq4/group_phq4_001/phq4_worrying\"                          \n [5,] \"group_homevisitquestionnaires/group_health/group_phq4/group_phq4_001/phq4_littleinterest\"                    \n [6,] \"group_homevisitquestionnaires/group_health/group_phq4/group_phq4_001/phq4_down\"                              \n [7,] \"group_homevisitquestionnaires/group_health/group_phq4/comments_phq4\"                                         \n [8,] \"group_homevisitquestionnaires/group_rothbart/group_rothbartinstructions/rothbart_instructions1\"              \n [9,] \"group_homevisitquestionnaires/group_rothbart/group_rothbartinstructions/rothbart_instructions2\"              \n[10,] \"group_homevisitquestionnaires/group_rothbart/group_rothbart_001/rothbart_questions/rothbart_unfamiliarperson\"\n[11,] \"group_homevisitquestionnaires/group_rothbart/group_rothbart_001/rothbart_questions/rothbart_troubletask\"     \n[12,] \"group_homevisitquestionnaires/group_rothbart/group_rothbart_001/rothbart_questions/rothbart_companyofchild\"  \n      [,2]                                                                                                       \n [1,] \"group_homevisitquestionnaires/group_health/group_drinking/comments_drinking\"                              \n [2,] \"group_homevisitquestionnaires/group_health/group_phq4/Experimenter_These_stions_are_about_you\"            \n [3,] \"group_homevisitquestionnaires/group_health/group_phq4/comments_phq4\"                                      \n [4,] \"group_homevisitquestionnaires/group_rothbart/group_dd2kz32/instructor_rothbart\"                           \n [5,] \"group_homevisitquestionnaires/group_rothbart/group_dd2kz32/instructions_rothbart2\"                        \n [6,] \"group_homevisitquestionnaires/group_rothbart/rothbart_questions/rothbart_questions_header\"                \n [7,] \"group_homevisitquestionnaires/group_rothbart/rothbart_questions/When_approached_by_a_ld_cling_to_a_parent\"\n [8,] \"group_homevisitquestionnaires/group_rothbart/rothbart_questions/While_having_trouble_get_easily_irritated\"\n [9,] \"group_homevisitquestionnaires/group_rothbart/rothbart_questions/When_a_familiar_chil_company_of_the_child\"\n[10,] \"group_homevisitquestionnaires/group_rothbart/rothbart_questions/When_offered_a_choic_uickly_and_go_for_it\"\n[11,] \"group_homevisitquestionnaires/group_rothbart/rothbart_questions/During_daily_or_even_eing_quietly_sung_to\"\n[12,] \"group_homevisitquestionnaires/group_rothbart/rothbart_questions/While_playing_outdoo_and_excitement_of_it\"\n```\n\n\n:::\n:::\n\n\n\n\n\nIt looks like the phq4 is *not* in `n2_5`.\n\nLet's check.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn2_5 |> stringr::str_detect(\"phq4\") |> sum()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2\n```\n\n\n:::\n:::\n\n\n\n\n\nYes, there are only two PHQ4-related questions in `df334099`.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf334099 |> names() |> stringr::str_detect(\"phq4\") |> sum()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2\n```\n\n\n:::\n:::\n\n\n\n\n\nThis path of reconciliation does not appear fruitful.\n\n## Make aggregate files {-}\n\n### non-MB-CDI files with $n=288$ columns {-}\n\n```\ntar_target(files_288_cols, \n  stringr::str_detect(home_visit_remove_identifiers, \n                      \"2[3458]_non_mbcdi.*_deidentified\\\\.csv\")\n)\n\ntar_target(df_merge_288_cols,\n    make_aggregate_data_file(\n        home_visit_remove_identifiers[files_288_cols])\n)\n```\n\n### non-MB-CDI files with $n=287$ columns {-}\n\n```\ntar_target(files_287_cols_1, \n  stringr::str_detect(home_visit_remove_identifiers, \n          \"2[69]_non_mbcdi.*_deidentified\\\\.csv\")),\ntar_target(files_287_cols_2, \n  stringr::str_detect(home_visit_remove_identifiers, \n          \"(740627|740630|740631)_non.*_deidentified\\\\.csv\")),\ntar_target(df_merge_287_cols_1,\n  make_aggregate_data_file(\n          home_visit_remove_identifiers[files_287_cols_1])),\ntar_target(df_merge_287_cols_2,\n  make_aggregate_data_file(\n          home_visit_remove_identifiers[files_287_cols_2])),\n```\n\n### Examine groups with $n=287$ cols {-}\n\nWe focus on the starting column where the column names diverge, column 92.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntargets::tar_load(df_merge_287_cols_1, store=\"../_targets\")\ntargets::tar_load(df_merge_287_cols_2, store=\"../_targets\")\nnames(df_merge_287_cols_1)[92]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_feeding_nutrition.instructions_feeding\"\n```\n\n\n:::\n\n```{.r .cell-code}\nnames(df_merge_287_cols_2)[92]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_locomotor_milestones.group_health.group_feeding_nutrition.instructions_feeding\"\n```\n\n\n:::\n:::\n\n\n\n\n\nThere is an erroneous `group_locomotor_milestones.` in the `df_merge_287_cols_2` column name.\n\nA bit of sleuthing determines that this `group_locomotor_milestones.` label is characteristic of columns 92 to 273.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(df_merge_287_cols_2)[92:273] |> stringr::str_detect(pattern = \"group_locomotor_milestones\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [16] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [31] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [46] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [61] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [76] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [91] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[106] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[121] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[136] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[151] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[166] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[181] TRUE TRUE\n```\n\n\n:::\n:::\n\n\n\n\n\nThe following should fix this.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nold_names <- names(df_merge_287_cols_2)\nnew_names <- old_names\nnew_names[92:273] <-\n  stringr::str_remove(new_names[92:273], \"group_locomotor_milestones\\\\.\")\nnames(df_merge_287_cols_2) <- new_names\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(df_merge_287_cols_2) == names(df_merge_287_cols_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [25]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [37]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [49]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [61]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [73]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [85]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [97]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[109]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[121] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[133] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[145] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[157] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[169] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[181] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[193] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[205] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[217]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[229]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[241]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[253]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE\n[265]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE\n[277] FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n```\n\n\n:::\n:::\n\n\n\n\n\nWe have a second problem with columns from 114 to 210.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrbind(names(df_merge_287_cols_1)[113:115], names(df_merge_287_cols_2)[113:115])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     [,1]                                                                                                                        \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_vision_tested.donotknow\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_vision_tested.donotknow\"\n     [,2]                                                                                                                                         \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.doctor_told_you\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.allergies\"      \n     [,3]                                                                                                                                       \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.allergies\"    \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.ear_infection\"\n```\n\n\n:::\n:::\n\n\n\n\n\nOne of the problems has to do with column 114. There is a question ending `doctor_told_you` in `names(df_merge_287_cols_1)` but not in `names(df_merge_287_cols_2)`.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(df_merge_287_cols_1) |> stringr::str_detect(pattern = \"doctor_told_you\") |> sum()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1\n```\n\n\n:::\n\n```{.r .cell-code}\nnames(df_merge_287_cols_2) |> stringr::str_detect(pattern = \"doctor_told_you\") |> sum()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n\n\n\n\nDeleting this question would create additional misalignments and further problems.\nWe cannot proceed without further discussion with our team.\n\nFor now, let's generate an array with all of the remaining differences in column names.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames_differ <- (names(df_merge_287_cols_2) != names(df_merge_287_cols_1))\nsum(names_differ)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 103\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrbind(names(df_merge_287_cols_1)[names_differ], names(df_merge_287_cols_2)[names_differ])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     [,1]                                                                                                                                         \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.doctor_told_you\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.allergies\"      \n     [,2]                                                                                                                                       \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.allergies\"    \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.ear_infection\"\n     [,3]                                                                                                                                       \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.ear_infection\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.asthma\"       \n     [,4]                                                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.asthma\"     \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.respiratory\"\n     [,5]                                                                                                                                          \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.respiratory\"     \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.gastrointestinal\"\n     [,6]                                                                                                                                          \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.gastrointestinal\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.comments_allergy_etc\"                           \n     [,7]                                                                                                               \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.comments_allergy_etc\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_injury_times\"  \n     [,8]                                                                                                             \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_injury_times\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.comment_injury\"    \n     [,9]                                                                                                                  \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.comment_injury\"         \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.comments_general_health\"\n     [,10]                                                                                                                 \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.comments_general_health\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_prenatal.instructions_prenatal\"        \n     [,11]                                                                                                         \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_prenatal.instructions_prenatal\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_prenatal.prenatal_care\"        \n     [,12]                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_prenatal.prenatal_care\"    \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_prenatal.comments_prenatal\"\n     [,13]                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_prenatal.comments_prenatal\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.pregnant_smoking\"  \n     [,14]                                                                                                      \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.pregnant_smoking\"   \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.smoking_trimester_1\"\n     [,15]                                                                                                      \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.smoking_trimester_1\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.smoking_trimester_2\"\n     [,16]                                                                                                      \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.smoking_trimester_2\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.smoking_trimester_3\"\n     [,17]                                                                                                      \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.smoking_trimester_3\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.mom_smoking_now\"    \n     [,18]                                                                                                         \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.mom_smoking_now\"       \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.mom_smoking_now_amount\"\n     [,19]                                                                                                         \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.mom_smoking_now_amount\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.smoking_house\"         \n     [,20]                                                                                                \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.smoking_house\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.smoking_car\"  \n     [,21]                                                                                                   \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.smoking_car\"     \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.comments_smoking\"\n     [,22]                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_smoking.comments_smoking\"  \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_drinking.pregnant_drinking\"\n     [,23]                                                                                                        \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_drinking.pregnant_drinking\"   \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_drinking.drinking_trimester_1\"\n     [,24]                                                                                                        \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_drinking.drinking_trimester_1\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_drinking.drinking_trimester_2\"\n     [,25]                                                                                                        \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_drinking.drinking_trimester_2\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_drinking.drinking_trimester_3\"\n     [,26]                                                                                                        \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_drinking.drinking_trimester_3\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_drinking.comments_drinking\"   \n     [,27]                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_drinking.comments_drinking\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_phq4.note_phq4\"            \n     [,28]                                                                                                 \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_phq4.note_phq4\"        \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_phq4.instructions_phq4\"\n     [,29]                                                                                                 \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_phq4.instructions_phq4\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_phq4.phq4_nervous\"     \n     [,30]                                                                                             \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_phq4.phq4_nervous\" \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_phq4.phq4_worrying\"\n     [,31]                                                                                                   \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_phq4.phq4_worrying\"      \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_phq4.phq4_littleinterest\"\n     [,32]                                                                                                   \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_phq4.phq4_littleinterest\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_phq4.phq4_down\"          \n     [,33]                                                                                             \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_phq4.phq4_down\"    \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_phq4.comments_phq4\"\n     [,34]                                                                                             \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_phq4.comments_phq4\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.instructions_rothbart1\"\n     [,35]                                                                                             \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.instructions_rothbart1\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.instructions_rothbart2\"\n     [,36]                                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.instructions_rothbart2\"                        \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.instructions_rothbart3\"\n     [,37]                                                                                                                        \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.instructions_rothbart3\"   \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_unfamiliarperson\"\n     [,38]                                                                                                                        \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_unfamiliarperson\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_troubletask\"     \n     [,39]                                                                                                                      \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_troubletask\"   \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_companyofchild\"\n     [,40]                                                                                                                        \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_companyofchild\"  \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_choiceactivities\"\n     [,41]                                                                                                                        \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_choiceactivities\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_quietlysung\"     \n     [,42]                                                                                                                       \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_quietlysung\"    \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_playingoutdoors\"\n     [,43]                                                                                                                       \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_playingoutdoors\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_morethan10\"     \n     [,44]                                                                                                                         \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_morethan10\"       \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_respondingremarks\"\n     [,45]                                                                                                                          \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_respondingremarks\" \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_excitedlovedadults\"\n     [,46]                                                                                                                          \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_excitedlovedadults\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_fiddlehair\"        \n     [,47]                                                                                                                  \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_fiddlehair\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_roughrowdy\"\n     [,48]                                                                                                                    \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_roughrowdy\"  \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_rockedhugged\"\n     [,49]                                                                                                                           \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_rockedhugged\"       \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_involvednewactivity\"\n     [,50]                                                                                                                           \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_involvednewactivity\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_tirequickly\"        \n     [,51]                                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_tirequickly\"  \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_callattention\"\n     [,52]                                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_callattention\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_tags\"         \n     [,53]                                                                                                                        \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_tags\"            \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_noisyenvironment\"\n     [,54]                                                                                                                        \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_noisyenvironment\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_energy\"          \n     [,55]                                                                                                                \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_energy\"  \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_vehicles\"\n     [,56]                                                                                                                \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_vehicles\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_active\"  \n     [,57]                                                                                                                 \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_active\"   \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_forbidden\"\n     [,58]                                                                                                                    \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_forbidden\"   \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_sadlytearful\"\n     [,59]                                                                                                                    \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_sadlytearful\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_downblue\"    \n     [,60]                                                                                                                \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_downblue\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_runhouse\"\n     [,61]                                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_runhouse\"     \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_excitingevent\"\n     [,62]                                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_excitingevent\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_tempertantrum\"\n     [,63]                                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_tempertantrum\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_waitpatiently\"\n     [,64]                                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_waitpatiently\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_rockedsmile\"  \n     [,65]                                                                                                                   \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_rockedsmile\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_mold\"       \n     [,66]                                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_mold\"         \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_interactadult\"\n     [,67]                                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_interactadult\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_careful\"      \n     [,68]                                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_careful\"      \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_enternewplace\"\n     [,69]                                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_enternewplace\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_crymorethan3\" \n     [,70]                                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_crymorethan3\" \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_easilysoothed\"\n     [,71]                                                                                                                     \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_easilysoothed\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_busyother\"    \n     [,72]                                                                                                                       \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_busyother\"      \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_differentpeople\"\n     [,73]                                                                                                                       \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.group_rothbartquestions.rothbart_differentpeople\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.comments_rothbart\"                               \n     [,74]                                                                                             \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_rothbart.comments_rothbart\"     \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.mediause_instructions1\"\n     [,75]                                                                                             \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.mediause_instructions1\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.home_technology\"       \n     [,76]                                                                                         \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.home_technology\"   \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.home_technology.tv\"\n     [,77]                                                                                          \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.home_technology.tv\" \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.home_technology.dvd\"\n     [,78]                                                                                               \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.home_technology.dvd\"     \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.home_technology.computer\"\n     [,79]                                                                                               \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.home_technology.computer\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.home_technology.ipad\"    \n     [,80]                                                                                                      \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.home_technology.ipad\"           \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.home_technology.educationalgame\"\n     [,81]                                                                                                      \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.home_technology.educationalgame\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.home_technology.videogame\"      \n     [,82]                                                                                                \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.home_technology.videogame\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.technology_child_tv\"      \n     [,83]                                                                                          \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.technology_child_tv\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.tv_how\"             \n     [,84]                                                                                           \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.tv_how\"              \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.technology_child_dvd\"\n     [,85]                                                                                           \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.technology_child_dvd\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.dvd_how\"             \n     [,86]                                                                                                \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.dvd_how\"                  \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.technology_child_computer\"\n     [,87]                                                                                                \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.technology_child_computer\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.computer_how\"             \n     [,88]                                                                                            \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.computer_how\"         \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.technology_child_ipad\"\n     [,89]                                                                                            \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.technology_child_ipad\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.ipad_how\"             \n     [,90]                                                                                                   \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.ipad_how\"                    \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.technology_child_educational\"\n     [,91]                                                                                                   \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.technology_child_educational\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.educational_how\"             \n     [,92]                                                                                                 \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.educational_how\"           \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.technology_child_videogame\"\n     [,93]                                                                                                 \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.technology_child_videogame\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.videogame_how\"             \n     [,94]                                                                                       \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.videogame_how\"   \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.tv_hours_per_day\"\n     [,95]                                                                                            \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.tv_hours_per_day\"     \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.note_tv_hours_per_day\"\n     [,96]                                                                                                                \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.note_tv_hours_per_day\"                    \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.group_techuse.instructions_technology_use\"\n     [,97]                                                                                                                \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.group_techuse.instructions_technology_use\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.group_techuse.technology_use_scale\"       \n     [,98]                                                                                                  \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_typical_day.instructions_typicalday\" \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_typical_day.instructions_typical_day\"\n     [,99]                                                                                            \n[1,] \"group_combinedquestionnaires.group_databrary.note_databraryspiel1\"                              \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_databrary.note_databraryspiel1\"\n     [,100]                                                                                           \n[1,] \"group_combinedquestionnaires.group_databrary.note_databraryspiel2\"                              \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_databrary.note_databraryspiel2\"\n     [,101]                                                                                           \n[1,] \"group_combinedquestionnaires.group_databrary.note_databraryspiel3\"                              \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_databrary.note_databraryspiel3\"\n     [,102]                                                                                            \n[1,] \"group_combinedquestionnaires.group_databrary.acknowledge_databrary\"                              \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_databrary.acknowledge_databrary\"\n     [,103]                                                                                       \n[1,] \"group_combinedquestionnaires.group_databrary.note_saveasdraft\"                              \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_databrary.note_saveasdraft\"\n```\n\n\n:::\n:::\n\n\n\n\n\nVisual inspection suggests that these are similar with the following deviations:\n\n- As noted, `df_merge_287_cols_1` has a column ending `doctor_told_you` that is not present in `df_merge_287_cols_2`.\n- `df_merge_287_cols_2` has a column ending `technology_use_scale` that is not present in the `df_merge_287_cols_1`\n- There are a set of fields in `group_databrary` that do not align exactly. We will almost certainly delete these, so the misalignment is not a huge problem.\n\nAs an exploration, let's see if we can reconcile these by deleting the non-aligning columns.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf1 <- df_merge_287_cols_1\ndf2 <- df_merge_287_cols_2\n\ndf1 <- df1 %>%\n  dplyr::select(., -contains('doctor_told_you'))\n\ndf2 <- df2 %>%\n  dplyr::select(., -contains('technology_use_scale'))\n\nold_names <- names(df2)\nnew_names <- old_names\nnew_names[92:273] <- stringr::str_remove(new_names[92:273], \"group_locomotor_milestones\\\\.\")\nnames(df2) <- new_names\n\nnames(df1) == names(df2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [25]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [37]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [49]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [61]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [73]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [85]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [97]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[109]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[121]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[133]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[145]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[157]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[169]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[181]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[193]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[205]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[217]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[229]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[241]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[253]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE\n[265]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE\n[277] FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n```\n\n\n:::\n:::\n\n\n\n\n\nThis looks promising.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrbind(names(df1)[263], names(df2)[263])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     [,1]                                                                                                   \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_typical_day.instructions_typicalday\" \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_typical_day.instructions_typical_day\"\n```\n\n\n:::\n:::\n\n\n\n\n\nThis is easily fixed.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(df1)[263] <- names(df2)[263]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrbind(names(df1)[273:275], names(df2)[273:275])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     [,1]                                                                                             \n[1,] \"group_combinedquestionnaires.group_databrary.note_databraryspiel1\"                              \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_databrary.note_databraryspiel1\"\n     [,2]                                                                                             \n[1,] \"group_combinedquestionnaires.group_databrary.note_databraryspiel2\"                              \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_databrary.note_databraryspiel2\"\n     [,3]                                                                                             \n[1,] \"group_combinedquestionnaires.group_databrary.note_databraryspiel3\"                              \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_databrary.note_databraryspiel3\"\n```\n\n\n:::\n:::\n\n\n\n\n\nThe last misalignments relate to Databrary fields.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf1 <- df1 %>%\n  dplyr::select(., -contains('group_databrary'))\n\ndf2 <- df2 %>%\n  dplyr::select(., -contains('group_databrary'))\n\nnames(df1) == names(df2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [16] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [31] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [46] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [61] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [76] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n [91] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[106] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[121] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[136] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[151] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[166] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[181] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[196] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[211] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[226] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[241] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[256] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[271] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n```\n\n\n:::\n:::\n\n\n\n\n\nSuccess!\n\n## Combining the two groups of datasets {-}\n\nNow, let's go back to the data frame with 288 cols and see if we can bring these into alignment.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntargets::tar_load(df_merge_288_cols, store=\"../_targets\")\n\ndf3 <- df_merge_288_cols\n\ndf3 <- df3 %>%\n  dplyr::select(., -contains('group_databrary'))\n\nc(dim(df1), dim(df2), dim(df3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 230 281  53 281 468 283\n```\n\n\n:::\n\n```{.r .cell-code}\nnames(df1) == names(df3)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in names(df1) == names(df3): longer object length is not a multiple of\nshorter object length\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [25]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [37]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [49]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [61]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [73]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [85]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [97]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[109]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[121] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[133] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[145] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[157] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[169] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[181] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[193] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[205] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[217] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[229] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[241] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[253] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[265] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[277] FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n```\n\n\n:::\n\n```{.r .cell-code}\nrbind(names(df1)[114:115], names(df3)[114:115])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     [,1]                                                                                                                                         \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.allergies\"      \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.doctor_told_you\"\n     [,2]                                                                                                                                       \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.ear_infection\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_health.group_general_health.child_allergies_infections_ill.allergies\"    \n```\n\n\n:::\n:::\n\n\n\n\n\nOnce again, there appears to be a problem with the 'doctor_told_you' field. We'll delete it to see if this fixes one of the problems.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf3 <- df3 %>%\n  dplyr::select(., -contains('doctor_told_you'))\n\nnames(df1) == names(df3)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in names(df1) == names(df3): longer object length is not a multiple of\nshorter object length\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [25]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [37]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [49]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [61]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [73]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [85]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [97]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[109]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[121]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[133]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[145]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[157]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[169]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[181]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[193]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[205]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[217] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[229] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[241] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[253] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[265] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[277] FALSE FALSE FALSE FALSE FALSE FALSE\n```\n\n\n:::\n:::\n\n\n\n\n\nWe still have misalignments at column 210.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrbind(names(df1)[210:213], names(df3)[210:213])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     [,1]                                                                                                          \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.group_techuse.meals\"               \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.group_techuse.technology_use_scale\"\n     [,2]                                                                                              \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.group_techuse.playtime\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.group_techuse.meals\"   \n     [,3]                                                                                              \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.group_techuse.bedtime\" \n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.group_techuse.playtime\"\n     [,4]                                                                                                    \n[1,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.group_techuse.transportation\"\n[2,] \"group_combinedquestionnaires.group_homevisitquestionnaires.group_mediause.group_techuse.bedtime\"       \n```\n\n\n:::\n:::\n\n\n\n\n\nThe 'technology_use_scale` exists in one but not the other.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf3 <- df3 %>%\n  dplyr::select(., -contains('technology_use_scale'))\n\nrbind(dim(df1), dim(df3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     [,1] [,2]\n[1,]  230  281\n[2,]  468  281\n```\n\n\n:::\n\n```{.r .cell-code}\nnames(df1) == names(df3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [25]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [37]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [49]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [61]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [73]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [85]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n [97]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[109]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[121]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[133]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[145]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[157]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[169]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[181]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[193]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[205]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[217]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[229]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[241]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[253]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE\n[265]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE\n[277]  TRUE  TRUE  TRUE  TRUE  TRUE\n```\n\n\n:::\n:::\n\n\n\n\n\n:::{.rmdimportant}\nFuture versions of the workflow will need to handle this more elegantly. \n\nOption 1: Fix the underlying forms.\n\nOption 2: Add the 'missing' columns as NA in post-processing.\n:::\n\nFor now, I'm going to create functions that align these data frames.\nThese are incorporated into `R/functions.R` so we do not source them again here.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nremove_technology_use_scale <- function(df) {\n  dplyr::select(df, -contains('technology_use_scale'))\n}\n\nremove_doctor_told_you <- function(df) {\n  dplyr::select(df, -contains('doctor_told_you'))\n}\n\nremove_databrary_fields <- function(df) {\n  dplyr::select(df, -contains('group_databrary'))\n}\n\nreconcile_typicalday <- function(df) {\n  names(df) <- stringr::str_replace_all(names(df), 'typicalday', 'typical_day')\n  df\n}\n\nremove_permissive_locomotor_milestones_label <- function(df) {\n  old_names <- names(df)\n  new_names <- old_names\n  contains_locomotor <-\n    stringr::str_detect(new_names, pattern = \"locomotor_milestones.*health|division|rothbart|mediause|pets|typical|acknowledge\")\n  new_names[contains_locomotor] <-\n    stringr::str_remove(new_names[contains_locomotor], \"group_locomotor_milestones\\\\.\")\n  names(df) <- new_names\n  df\n}\n\nremove_X_meta_cols <- function(df) {\n  dplyr::select(df, -contains(\"X_\"), -contains(\"meta.instanceID\"))\n}\n\nremove_redundant_group_labels <- function(df) {\n  names(df) <- stringr::str_remove_all(names(df), 'group_homevisitquestionnaires\\\\.')\n  names(df) <- stringr::str_remove_all(names(df), 'group_combinedquestionnaires\\\\.')\n  df\n}\n\nclean_dfs <- function(df) {\n  df %>%\n    reconcile_typicalday() %>%\n    remove_technology_use_scale() %>%\n    remove_doctor_told_you() %>%\n    remove_permissive_locomotor_milestones_label() %>%\n    remove_databrary_fields() %>%\n    remove_X_meta_cols() %>%\n    remove_redundant_group_labels()\n}\n```\n:::\n\n\n\n\n\nLet's test this workflow with the unmodified files.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntargets::tar_load(df_merge_287_cols_1, store=\"../_targets\")\ntargets::tar_load(df_merge_287_cols_2, store=\"../_targets\")\ntargets::tar_load(df_merge_288_cols, store=\"../_targets\")\n\ndf1m <- clean_dfs(df_merge_287_cols_1)\ndim(df1m)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 230 272\n```\n\n\n:::\n\n```{.r .cell-code}\ndf2m <- clean_dfs(df_merge_287_cols_2)\ndim(df2m)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1]  53 272\n```\n\n\n:::\n\n```{.r .cell-code}\ndf3m <- clean_dfs(df_merge_288_cols)\ndim(df3m)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 468 272\n```\n\n\n:::\n\n```{.r .cell-code}\n(names(df1m) == names(df2m)) |> sum()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 272\n```\n\n\n:::\n\n```{.r .cell-code}\n(names(df1m) == names(df3m)) |> sum()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 272\n```\n\n\n:::\n:::\n\n\n\n\n\n### Merging files at last {-}\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- rbind(df1m, df2m, df3m)\n```\n:::\n\n\n\n\n\n::: {.rmdnote}\nAs of 2022-12-15, the above has now been incorporated into `R/functions.R` and into the `_targets.R` workflow.\n:::\n\n## Merge with Databrary info {-}\n\nFor each session (row) in the merged data frame, we pull data from the associated Databrary volume and session.\nThese data are merged with that drawn from KBT.\n\n```\ntar_target(\n  home_visit_w_databrary_df,\n  add_databrary_info_to_home_visit_df(home_visit_df)\n)\n```\n\nThe `add_databrary_info_to_home_visit()` function in `R/functions.R` does most of the work.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}