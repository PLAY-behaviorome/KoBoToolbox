---
title: 'PLAY Release 1.0: Surveys'
subtitle: "Version `r Sys.time()`"
author: Rick Gilmore
output:
  ioslides_presentation:
    css: css/ioslides.css
    logo: img/PLAY-leaf.png 
    widescreen: true
    incremental: false
    transition: default
  html_document:
    code_folding: hide
    self_contained: yes
    toc: yes
    toc_depth: 3
    toc_float: yes
params:
  databrary_login: 'rogilmore@psu.edu'
  databrary_vol: 1280
  non_MBCDI_session: 51539
  non_MBCDI_fn: 'PLAY_release_1.0_non_MBCDI_data' 
  release: 'release_1.0'
  use_databrary: yes
---

## Purpose

This document summarizes the workflow for the PLAY 1.0 data release related to the non-MBCDI survey data.

## Setup

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      fig.align = "center",
                      warning = FALSE)
```

The user should authenticate to Databrary using `databraryapi::login_db()` prior to knitting this document.

```{r login}
databraryapi::login_db(params$databrary_login)
```

---

Import helper functions and libraries

```{r source-helpers}
source("R/kobo_databrary_integration.R")
library(tidyverse) # for %>% pipe
```

## Import 

We read the CSV with the file name: "`r params$non_MBCDI_fn`" stored in volume `r params$databrary_vol` and session/folder `r params$non_MBCDI_session`.

```{r import-from-databrary}
if (params$use_databrary) {
  these_assets <-
    databraryapi::list_assets_in_session(params$non_MBCDI_session)
  this_asset <-
    dplyr::filter(these_assets, name == params$non_MBCDI_fn)
  play_merge <-
    databraryapi::read_csv_data_as_df(session_id = params$non_MBCDI_session,
                                      asset_id = this_asset$asset_id[1])
} else {
  play_merge <-
    readr::read_csv("csv/release_1.0/aggregate/PLAY_release_1.0_non_MBCDI_data.csv")
}
```

There are $n=$ `r dim(play_merge)[1]` sessions in the data file.

# Site summaries

## Enrollment by site

```{r enrollment-by-site, include=FALSE}
play_w_sites <- readr::read_csv("csv/release_1.0/aggregate/PLAY_non_mbcdi_all_databrary.csv")

play_w_sites <- play_w_sites %>%
  dplyr::rename(., qa_group = group_name)
  
xtabs(formula = ~ site_id + qa_group, data = play_w_sites) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)

#rm(play_w_sites)
```

# Demographic data summaries

## QA status overall

```{r qa-status}
xtabs(formula = ~ qa_group, data = play_merge) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

## Age group by QA status

```{r qa-status-by-age-group}
xtabs(formula = ~ qa_group + age_group, data = play_merge) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

## Sex by age group

```{r}
xtabs(formula = ~ child_sex + age_group, data = play_merge) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

## Race and ethnicity

```{r}
xtabs(formula = ~ child_race + child_ethnicity, data = play_merge) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

## Spanish spoken to child

```{r}
lang_to_child <- play_merge %>%
  dplyr::rename(spanish_to_child = language_child.spanish)

xtabs(formula = ~ age_group + spanish_to_child, data = lang_to_child) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

# Locomotor milestones

```{r}
play_loco <- play_merge %>%
  dplyr::select(., age_group, child_sex, language_child, qa_group, 
                locomotor_milestones.who_walk.who_walk_onset_mo,
                locomotor_milestones.k_walk.k_walk_onset_mo,
                locomotor_milestones.crawl_onset.crawl_onset_mo) %>%
  dplyr::rename(., walk_mos_who = locomotor_milestones.who_walk.who_walk_onset_mo,
                walk_mos_kea = locomotor_milestones.k_walk.k_walk_onset_mo,
                crawl_mos = locomotor_milestones.crawl_onset.crawl_onset_mo)
```

## Crawl onset

```{r crawl-onset-hist}
play_loco %>%
  ggplot(.) +
  aes(crawl_mos, fill = child_sex) +
  geom_histogram(bins = 12)
```

## Walk onset (KEA criteria)

```{r walk-onset-kea-hist}
play_loco %>%
  ggplot(.) +
  aes(walk_mos_kea, fill = child_sex) +
  geom_histogram(bins = 12)
```

## Walk onset (WHO criteria)

```{r walk-onset-who-hist}
play_loco %>%
  ggplot(.) +
  aes(walk_mos_who, fill = child_sex) +
  geom_histogram(bins = 12)
```

## Walk (KEA) by walk (WHO) onset

```{r walk-who-by-walk-kea-scatter}
play_loco %>%
  ggplot(.) +
  aes(walk_mos_who, walk_mos_kea, color = child_sex) +
  geom_point() +
  xlim(8, 18) +
  ylim(8, 18) +
  theme(legend.position="bottom") -> walk_p

ggExtra::ggMarginal(walk_p, play_loco, walk_mos_who, walk_mos_kea, 
                    type = "density", margins = "both", groupColour = TRUE, groupFill = TRUE)
```

## Walk (KEA) by crawl onset

```{r walk-by-crawl-onset-scatter}
play_loco %>%
  ggplot(.) +
  aes(crawl_mos, walk_mos_kea, color = child_sex) +
  geom_point() +
  xlim(7, 15) +
  ylim(8, 18) +
  theme(legend.position="bottom") -> walk_p

ggExtra::ggMarginal(walk_p, play_loco, crawl_mos, walk_mos_kea, 
                    type = "density", margins = "both", groupColour = TRUE, groupFill = TRUE)
```

# PHQ-4

```{r}
# The Patient Health Questionnaire (PHQ-4) data must be changed into an ordered factor.

phq4_levels <- c('notatall', 'severaldays', 'morethanhalf', 'nearly')
phq4_labels <- c('not_at_all', 'several_days', 'more_than_half', 'nearly_every_day')

phq4 <- play_merge %>%
  dplyr::select(
    .,
    age_group,
    child_sex,
    health.phq4.phq4_nervous,
    health.phq4.phq4_worrying,
    health.phq4.phq4_littleinterest,
    health.phq4.phq4_down
  ) %>%
  dplyr::rename(
    .,
    nervous = health.phq4.phq4_nervous,
    worrying = health.phq4.phq4_worrying,
    little_interest = health.phq4.phq4_littleinterest,
    down = health.phq4.phq4_down
  ) %>%
  dplyr::mutate(
    .,
    nervous = factor(
      nervous,
      levels = phq4_levels,
      labels = phq4_labels,
      ordered = TRUE
    ),
    worrying = factor(
      worrying,
      levels = phq4_levels,
      labels = phq4_labels,
      ordered = TRUE
    ),
    little_interest = factor(
      little_interest,
      levels = phq4_levels,
      labels = phq4_labels,
      ordered = TRUE
    ),
    down = factor(
      down,
      levels = phq4_levels,
      labels = phq4_labels,
      ordered = TRUE
    )
  )
```

## Question...

> "*Over the last two weeks, how often have you been bothered by the following problems...*"

## "*...Feeling nervous, anxious, or on edge?*"

```{r}
l_nervous <- likert::likert(as.data.frame(phq4$nervous))
plot(l_nervous)
```

## "*...Not being able to stop or control worrying?*"

```{r}
l_worrying <- likert::likert(as.data.frame(phq4$worrying))
plot(l_worrying)
```

## "*...Little interest or pleasure in doing things?*"

```{r}
l_little_interest <- likert::likert(as.data.frame(phq4$little_interest))
plot(l_little_interest)
```

## "*...Feeling down, depressed, or hopeless?*"

```{r}
l_down <- likert::likert(as.data.frame(phq4$down))
plot(l_down)
```

# Health

```{r}
feeding <- play_merge %>%
  dplyr::select(., age_group, child_sex, language_child, qa_group, 
                health.feeding_nutrition.breastfeed,
                health.feeding_nutrition.solidfood_age) %>%
  dplyr::rename(., breastfeed = health.feeding_nutrition.breastfeed,
                solid_food_mos = health.feeding_nutrition.solidfood_age)
```

## Breastfeeding

```{r}
xtabs(formula = ~ child_sex + breastfeed, data = feeding) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

## Solid foods introduced

```{r}
feeding %>%
  ggplot(.) +
  aes(x = solid_food_mos, color = child_sex, fill = child_sex) +
  geom_histogram(bins = 5)
```

## Smoking/drinking

```{r}
smoking_drinking <- play_merge %>%
  dplyr::select(., age_group, child_sex, language_child, qa_group, 
                health.smoking.pregnant_smoking,
                health.drinking.pregnant_drinking) %>%
  dplyr::rename(., preg_smoking = health.smoking.pregnant_smoking,
                preg_drinking = health.drinking.pregnant_drinking)

```

```{r}
xtabs(formula = ~ preg_smoking + preg_drinking, smoking_drinking) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

## Sleeping position

```{r}
sleeping_pos <- play_merge %>%
  dplyr::select(., age_group, child_sex, language_child, qa_group, 
                health.general_health.child_sleeping_position ) %>%
  dplyr::rename(., child_sleeping_position = health.general_health.child_sleeping_position)

sleeping_pos$child_sleeping_position <- dplyr::recode(sleeping_pos$child_sleeping_position, nospecialway = "no_special_way")
```

```{r}
xtabs(formula = ~ child_sleeping_position, data = sleeping_pos) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

## Child health rating

```{r}
child_health <- play_merge %>%
  dplyr::select(., age_group, child_sex, language_child, qa_group, 
                health.general_health.child_health ) %>%
  dplyr::rename(., child_health_rating = health.general_health.child_health) %>%
  dplyr::mutate(., child_health_rating = factor(child_health_rating, levels = c('good', 'verygood', 'excellent'), ordered = TRUE))

plot(likert::likert(as.data.frame(child_health$child_health_rating)))
```

## See medical specialist

```{r}
med_specialist <- play_merge %>%
  dplyr::select(., age_group, child_sex, language_child, qa_group, 
                health.general_health.child_medical_specialist,
                health.general_health.comments_child_medical_special) %>%
  dplyr::rename(., see_med_specialist = health.general_health.child_medical_specialist,
                med_specialist_reason = health.general_health.comments_child_medical_special)
```

```{r}
xtabs(formula = ~ age_group + see_med_specialist, data = med_specialist) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

## Recently vaccinated

```{r}
vaccination <- play_merge %>%
  dplyr::select(., age_group, child_sex, language_child, qa_group, 
                health.general_health.child_vaccination ) %>%  
  dplyr::rename(., child_vaccinated_last_4wks = health.general_health.child_vaccination )
```

```{r}
xtabs(formula = ~ age_group + child_vaccinated_last_4wks, data = vaccination) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

## Vision screen

```{r}
play_vis_aud <- play_merge %>%
  dplyr::select(., age_group, child_sex, language_child, qa_group, 
                health.general_health.child_vision_tested,
                health.general_health.child_hearing_tested) %>%
  dplyr::rename(., vision_tested = health.general_health.child_vision_tested,
                hearing_tested = health.general_health.child_hearing_tested)

play_vis_aud$vision_tested <- dplyr::recode(play_vis_aud$vision_tested, afterhome = "after_home",
                                            birthhospital = "birth_hospital",
                                            `birthhospital afterhome` = "both_hospital_home",
                                            donotknow = "do_not_know")

play_vis_aud$hearing_tested <- dplyr::recode(play_vis_aud$hearing_tested, afterhome = "after_home",
                                            birthhospital = "birth_hospital",
                                            `birthhospital afterhome` = "both_hospital_home",
                                            donotknow = "do_not_know")
```

```{r}
xtabs(formula = ~ age_group + vision_tested, data = play_vis_aud) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

## Hearing screen

```{r}
xtabs(formula = ~ age_group + hearing_tested, data = play_vis_aud) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

# Media use

```{r}
media_use_cols <- stringr::str_detect(names(play_merge), 'mediause')
media_use_col_index <- (1:length(names(play_merge)))[media_use_cols]

media_use <- play_merge %>%
  dplyr::select(., age_group, child_sex, language_child, qa_group, 
                all_of(media_use_col_index)) %>%
  dplyr::rename(., have_tv =  mediause.home_technology.tv,
                have_dvd = mediause.home_technology.dvd,
                have_computer = mediause.home_technology.computer,
                have_tablet = mediause.home_technology.ipad,
                have_videogame = mediause.home_technology.videogame,
                have_educationalgame = mediause.home_technology.educationalgame,
                child_use_tv = mediause.technology_child_tv,
                child_use_tv_how = mediause.tv_how,
                child_use_dvd = mediause.technology_child_dvd,
                child_use_dvd_how = mediause.dvd_how,
                child_use_computer = mediause.technology_child_computer,
                child_use_computer_how = mediause.computer_how,
                child_use_tablet = mediause.technology_child_ipad,
                child_use_tablet_how = mediause.ipad_how,
                child_use_edugame = mediause.technology_child_educational,
                child_use_edugame_how = mediause.educational_how,
                child_use_videogame = mediause.technology_child_videogame,
                child_use_videogame_how = mediause.videogame_how)
```

## TV

```{r child-use-tv}
xtabs(formula = ~ age_group + child_use_tv, data = media_use) %>%
  knitr::kable(., format = 'html', caption = "Child use TV") %>%
  kableExtra::kable_material(.)
```

## Tablet

```{r child-use-tablet}
xtabs(formula = ~ age_group + child_use_tablet, data = media_use) %>%
  knitr::kable(., format = 'html', caption = "Child use tablet") %>%
  kableExtra::kable_material(.)
```

## Computer

```{r child-use-computer}
xtabs(formula = ~ age_group + child_use_computer, data = media_use) %>%
  knitr::kable(., format = 'html', caption = "Child use computer") %>%
  kableExtra::kable_material(.)
```

## Educational games

```{r child-use-edugame}
xtabs(formula = ~ age_group + child_use_edugame, data = media_use) %>%
  knitr::kable(., format = 'html', caption = "Child use educational games") %>%
  kableExtra::kable_material(.)
```

## Videogames

```{r child-use-videogames}
xtabs(formula = ~ age_group + child_use_videogame, data = media_use) %>%
  knitr::kable(., format = 'html', caption = "Child use videogames") %>%
  kableExtra::kable_material(.)
```

# Pets

```{r}
pets <- play_merge %>%
  dplyr::select(., age_group, child_sex, language_child, qa_group, 
                pets.pets_at_home,
                pets.pets_types_number,
                pets.pets_indoors_outdoors,
                pets.comments_pets) %>%
  dplyr::rename(., pets_at_home = pets.pets_at_home,
                pets_where_live = pets.pets_indoors_outdoors) %>%
  dplyr::mutate(., have_dog = stringr::str_detect(pets.pets_types_number, '[dD]og'),
                have_cat = stringr::str_detect(pets.pets_types_number, '[cC]at'),
                have_bird = stringr::str_detect(pets.pets_types_number, '[bB]ird'),
                have_fish = stringr::str_detect(pets.pets_types_number, '[fF]ish'))
```

## Pets at home/where live

```{r}
xtabs(formula = ~ pets_at_home + pets_where_live, data = pets) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

## Types of pets

```{r}
pets %>%
  dplyr::filter(., pets_at_home == "yes") %>%
  dplyr::select(., pets_at_home, have_dog, have_cat, have_bird, have_fish)
```

# Typical Day

```{r}
typical_day <- play_merge %>%
  dplyr::select(., age_group, child_sex, language_child, qa_group, 
                typical_day.typical_behavior,
                typical_day.typical_activities,
                typical_day.typical_nightmorning,
                typical_day.typical_otherthanme) %>%
  dplyr::rename(., typical_behavior = typical_day.typical_behavior,
                typical_activities = typical_day.typical_activities,
                typical_nightmorning = typical_day.typical_nightmorning,
                typical_other_than_researcher = typical_day.typical_otherthanme)
```

## Typical behavior

```{r}
xtabs(formula = ~ typical_behavior + age_group, data = typical_day) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

```{r}
xtabs(formula = ~ typical_behavior + qa_group, data = typical_day) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

## Typical activities

```{r}
xtabs(formula = ~ typical_activities + age_group, data = typical_day) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

```{r}
xtabs(formula = ~ typical_activities + qa_group, data = typical_day) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

## Typical night/morning

```{r}
xtabs(formula = ~ typical_nightmorning + age_group, data = typical_day) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

```{r}
xtabs(formula = ~ typical_nightmorning + qa_group, data = typical_day) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

## Typical other than researcher presence

```{r}
xtabs(formula = ~ typical_other_than_researcher + age_group, data = typical_day) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

```{r}
xtabs(formula = ~ typical_other_than_researcher + qa_group, data = typical_day) %>%
  knitr::kable(., format = 'html') %>%
  kableExtra::kable_material(.)
```

# Rothbart (ECBQ)

```{r clean-ecbq}
ecbq <- play_merge %>%
  dplyr::select(.,
                age_group,
                child_sex,
                language_child,
                qa_group | contains("rothbart"))

rename_ecbq <- function(old_names) {
  new_names <-
    stringr::str_remove(old_names, "rothbart\\.rothbartquestions\\.rothbart_")
}

recode_ecbq <- function(this_var_index, df) {
  new_var <- dplyr::recode_factor(df[,this_var_index], 
                       never = "never",
                       veryrarely = "very_rarely",
                       lessthanhalf = "less_than_half",
                       abouthalf = "about_half",
                       almostalways = "almost_always",
                       always = "always",
                       .default = NA_character_)
  df[, this_var_index] <- new_var
  df
}

ecbq <- ecbq %>%
  dplyr::rename_with(., rename_ecbq, contains("rothbart"))

# Have to do better than this...
ecbq <- recode_ecbq(5, ecbq)
ecbq <- recode_ecbq(6, ecbq)
ecbq <- recode_ecbq(7, ecbq)
ecbq <- recode_ecbq(8, ecbq)
ecbq <- recode_ecbq(9, ecbq)
ecbq <- recode_ecbq(10, ecbq)
ecbq <- recode_ecbq(11, ecbq)
ecbq <- recode_ecbq(12, ecbq)
ecbq <- recode_ecbq(13, ecbq)
ecbq <- recode_ecbq(14, ecbq)
ecbq <- recode_ecbq(15, ecbq)
ecbq <- recode_ecbq(16, ecbq)
ecbq <- recode_ecbq(17, ecbq)
ecbq <- recode_ecbq(18, ecbq)
ecbq <- recode_ecbq(19, ecbq)
ecbq <- recode_ecbq(20, ecbq)
ecbq <- recode_ecbq(21, ecbq)
ecbq <- recode_ecbq(22, ecbq)
ecbq <- recode_ecbq(23, ecbq)
ecbq <- recode_ecbq(24, ecbq)
ecbq <- recode_ecbq(25, ecbq)
ecbq <- recode_ecbq(26, ecbq)
ecbq <- recode_ecbq(27, ecbq)
ecbq <- recode_ecbq(28, ecbq)
ecbq <- recode_ecbq(29, ecbq)
ecbq <- recode_ecbq(30, ecbq)
ecbq <- recode_ecbq(31, ecbq)
ecbq <- recode_ecbq(32, ecbq)
ecbq <- recode_ecbq(33, ecbq)
ecbq <- recode_ecbq(34, ecbq)
ecbq <- recode_ecbq(35, ecbq)
ecbq <- recode_ecbq(36, ecbq)
ecbq <- recode_ecbq(37, ecbq)
ecbq <- recode_ecbq(38, ecbq)
ecbq <- recode_ecbq(39, ecbq)
ecbq <- recode_ecbq(40, ecbq)
```

```{r ecbq-qs, echo=FALSE}
qs <- readr::read_csv("data_dict/release_1.0_non_mbcdi_data_dictionary_clean.csv", show_col_types = FALSE)
ecbq_qs <- qs %>%
  dplyr::filter(., question_group == "rothbart")
```

## `r ecbq_qs$question[3]`

## `r ecbq_qs$question[4]`

```{r}
plot(likert::likert(ecbq[ , 5, drop = FALSE]))
```

## `r ecbq_qs$question[5]`

```{r}
plot(likert::likert(ecbq[, 6, drop = FALSE]))
```

## `r ecbq_qs$question[6]`

```{r}
plot(likert::likert(ecbq[ , 7, drop = FALSE]))
```

## `r ecbq_qs$question[7]`

```{r}
plot(likert::likert(ecbq[, 8, drop = FALSE]))
```

## `r ecbq_qs$question[8]`

```{r}
plot(likert::likert(ecbq[ , 9, drop = FALSE]))
```

## `r ecbq_qs$question[9]`

```{r}
plot(likert::likert(ecbq[, 10, drop = FALSE]))
```

## `r ecbq_qs$question[10]`

```{r}
plot(likert::likert(ecbq[ , 11, drop = FALSE]))
```

## `r ecbq_qs$question[11]`

```{r}
plot(likert::likert(ecbq[, 12, drop = FALSE]))
```

## `r ecbq_qs$question[12]`

```{r}
plot(likert::likert(ecbq[ , 13, drop = FALSE]))
```

## `r ecbq_qs$question[13]`

```{r}
plot(likert::likert(ecbq[, 14, drop = FALSE]))
```

## `r ecbq_qs$question[14]`

```{r}
plot(likert::likert(ecbq[ , 15, drop = FALSE]))
```

## `r ecbq_qs$question[15]`

```{r}
plot(likert::likert(ecbq[, 16, drop = FALSE]))
```

## `r ecbq_qs$question[16]`

```{r}
plot(likert::likert(ecbq[ , 17, drop = FALSE]))
```

## `r ecbq_qs$question[17]`

```{r}
plot(likert::likert(ecbq[, 18, drop = FALSE]))
```

## `r ecbq_qs$question[18]`

```{r}
plot(likert::likert(ecbq[ , 19, drop = FALSE]))
```

## `r ecbq_qs$question[19]`

```{r}
plot(likert::likert(ecbq[, 20, drop = FALSE]))
```

## `r ecbq_qs$question[20]`

```{r}
plot(likert::likert(ecbq[, 21, drop = FALSE]))
```

## `r ecbq_qs$question[21]`

```{r}
plot(likert::likert(ecbq[, 22, drop = FALSE]))
```

## `r ecbq_qs$question[22]`

```{r}
plot(likert::likert(ecbq[, 23, drop = FALSE]))
```

## `r ecbq_qs$question[23]`

```{r}
plot(likert::likert(ecbq[, 24, drop = FALSE]))
```

## `r ecbq_qs$question[24]`

```{r}
plot(likert::likert(ecbq[, 25, drop = FALSE]))
```

## `r ecbq_qs$question[25]`

```{r}
plot(likert::likert(ecbq[, 26, drop = FALSE]))
```

## `r ecbq_qs$question[26]`

```{r}
plot(likert::likert(ecbq[, 27, drop = FALSE]))
```

## `r ecbq_qs$question[27]`

```{r}
plot(likert::likert(ecbq[, 28, drop = FALSE]))
```

## `r ecbq_qs$question[28]`

```{r}
plot(likert::likert(ecbq[, 29, drop = FALSE]))
```

## `r ecbq_qs$question[29]`

```{r}
plot(likert::likert(ecbq[, 30, drop = FALSE]))
```

## `r ecbq_qs$question[30]`

```{r}
plot(likert::likert(ecbq[, 31, drop = FALSE]))
```

## `r ecbq_qs$question[31]`

```{r}
plot(likert::likert(ecbq[, 32, drop = FALSE]))
```

## `r ecbq_qs$question[32]`

```{r}
plot(likert::likert(ecbq[, 33, drop = FALSE]))
```

## `r ecbq_qs$question[33]`

```{r}
plot(likert::likert(ecbq[, 34, drop = FALSE]))
```

# Clean-up

## Log-out of Databrary

```{r}
databraryapi::logout_db()
```
